AWSTemplateFormatVersion: 2010-09-09
Description: AWS CloudFormation Template for Global security groups

Mappings:
  VPCaddressPrefix:
    values:
      DMZVPCSubnet: '10.232.144.0/21'
      CoreVPCSubnet: '10.232.152.0/21'
      Az1CoreSubnet: '10.232.152.0/24'
      Az2CoreSubnet: '10.232.156.0/24'
      Az1ManagementSubnet: '10.232.153.128/28'
      Az2ManagementSubnet: '10.232.157.128/28'
      VoiceNetwork1Trust: '10.232.192.0/24'
      VoiceNetwork2Trust: '10.232.196.0/24'
      voicetrustOctet: '10.232.192.0/24'
      voiceuntrustOctet: '10.232.113.0/25'
      voicemgmtOctet: '10.232.194.128/25'
      voice2trustOctet: '10.232.196.0/24'
      voice2untrustOctet: '10.232.117.0/25'
      voice2mgmtOctet: '10.232.198.128/25'
      SharedEKSUKSov: '10.232.160.0/21'
      ASideADCSelfIP : '100.18.0.1'
      BSideADCSelfIP : '100.18.0.2'
      ASideADCSNATIP : '100.18.0.3'
      BSideADCSNATIP : '100.18.0.4'
      Corpdwsourceip1: '204.176.204.140/32'
      Corpdwsourceip2: '204.176.204.141/32'
      Corpdwsourceip3: '204.176.204.142/32'
      RundeckServerIP: '10.232.153.137/32'
      BMPCSServerIP: '10.232.152.227/32'
      AsideINPRO01: '10.232.152.64/32'
      BsideINPRO01: '10.232.156.70/32'
      Owner: 'Network Teams'

Parameters:
  SystemName:
    Description: System Name
    Type: String
    Default: RibbonSWE-VoiceNetwork
    MaxLength: '26'
    AllowedPattern: '^[A-Za-z]{1}[-A-Za-z0-9]*[A-Za-z0-9]{1}$'
    ConstraintDescription: 'Enter valid system name.  Regex: ^[A-Za-z]{1}[-A-Za-z0-9]*[A-Za-z0-9]{1}$ '

Resources:
#  SBCTrustInterface:
#    Type: 'AWS::EC2::SecurityGroup'
#    Properties:
#      VpcId: !ImportValue VoiceNetwork-Vpc
#      GroupDescription: Security group for Voice Trust Interfaces
#      Tags:
#        - Key: Name
#          Value: voicenetwork_sbc_trust_interface
#        - Key: DeviceType
#          Value: Network Security Group
#        - Key: Cluster
#          Value: Global
#        - Key: InfrastructureOwner
#          Value: Network Teams
#        - Key: ApplicationOwner
#          Value: Network Teams
#        - Key: Product
#          Value: SecurityGroup
#      SecurityGroupEgress:
#        - IpProtocol: -1
#          CidrIp: 0.0.0.0/0
#  SBCTrustInterface2:
#    Type: 'AWS::EC2::SecurityGroup'
#    Properties:
#      VpcId: !ImportValue VoiceNetwork2-Vpc
#      GroupDescription: Security group for Voice Trust Interfaces
#      Tags:
#        - Key: Name
#          Value: voicenetwork_sbc_trust_interface
#        - Key: DeviceType
#          Value: Network Security Group
#        - Key: Cluster
#          Value: Global
#        - Key: InfrastructureOwner
#          Value: Network Teams
#        - Key: ApplicationOwner
#          Value: Network Teams
#        - Key: Product
#          Value: SecurityGroup
#      SecurityGroupEgress:
#        - IpProtocol: -1
#          CidrIp: 0.0.0.0/0

  NoConnTrackF5:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue CoreNetwork-Vpc
      GroupDescription: Security group for Core Interface of F5
      Tags:
        - Key: Name
          Value: no_conntrack_core_F5_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: Cluster
          Value: Global
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
        - IpProtocol: -1
          CidrIp: 0.0.0.0/0
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
      SecurityGroupEgress:
        - IpProtocol: -1
          CidrIp: 0.0.0.0/0
  NoConnTrack:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue CoreNetwork-Vpc
      GroupDescription: Security group for Infrastructure
      Tags:
        - Key: Name
          Value: no_conntrack_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: Cluster
          Value: Global
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
        - IpProtocol: -1
          CidrIp: 0.0.0.0/0
      SecurityGroupEgress:
        - IpProtocol: -1
          CidrIp: 0.0.0.0/0
  NoConnTrackUntrust:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue CoreNetwork-Vpc
      GroupDescription: Security group for Infrastructure
      Tags:
        - Key: Name
          Value: no_conntrack_untrust_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: Cluster
          Value: Global
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
        - IpProtocol: udp
          FromPort: 500
          ToPort: 500
          CidrIp: 0.0.0.0/0
      SecurityGroupEgress:
        - IpProtocol: -1
          CidrIp: 0.0.0.0/0
  ClusterALBSecurityGroup:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue DMZNetwork-Vpc
      GroupDescription: Security group for ALB
      Tags:
        - Key: Name
          Value: alb_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: Cluster
          Value: Global
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: 80
          ToPort: 80
          CidrIp: 0.0.0.0/0
        - IpProtocol: tcp
          FromPort: 443
          ToPort: 443
          CidrIp: 0.0.0.0/0
        - IpProtocol: tcp
          FromPort: 8800
          ToPort: 8800
          CidrIp: 0.0.0.0/0
      SecurityGroupEgress:
        - IpProtocol: -1
          CidrIp: 0.0.0.0/0

  DomainControllerSG:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue CoreNetwork-Vpc
      GroupDescription: sg for Domain Controllers
      Tags:
        - Key: Name
          Value: global_systems_domain_controllers_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: Cluster
          Value: Global
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
      - IpProtocol: "tcp"   #LDAP
        CidrIp: "0.0.0.0/0"
        FromPort: "389"
        ToPort: "389"
        Description: "LDAP"
      - IpProtocol: "udp"   #LDAP
        CidrIp: "0.0.0.0/0"
        FromPort: "389"
        ToPort: "389"
        Description: "LDAP"
      - IpProtocol: "tcp"   #LDAP SSL
        CidrIp: "0.0.0.0/0"
        FromPort: "636"
        ToPort: "636"
        Description: "LDAP SSL"
      - IpProtocol: "tcp"   #Kerberos
        CidrIp: "0.0.0.0/0"
        FromPort: "88"
        ToPort: "88"
        Description: "Kerberos"
      - IpProtocol: "udp"   #Kerberos
        CidrIp: "0.0.0.0/0"
        FromPort: "88"
        ToPort: "88"
        Description: "Kerberos"
      - IpProtocol: "tcp"   #DNS
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
        Description: "DNS"
      - IpProtocol: "udp"   #DNS
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
        Description: "DNS"
      - IpProtocol: "tcp"   #SMB
        CidrIp: "0.0.0.0/0"
        FromPort: "445"
        ToPort: "445"
        Description: "SMB"
      - IpProtocol: "udp"   #SMB
        CidrIp: "0.0.0.0/0"
        FromPort: "445"
        ToPort: "445"
        Description: "SMB"
      - IpProtocol: "tcp"   #SMTP
        CidrIp: "0.0.0.0/0"
        FromPort: "25"
        ToPort: "25"
        Description: "SMTP"
      - IpProtocol: "tcp"   #RPC
        CidrIp: "0.0.0.0/0"
        FromPort: "135"
        ToPort: "135"
        Description: "RPC"
      - IpProtocol: "tcp"   #RPC DCOM FRS
        CidrIp: "0.0.0.0/0"
        FromPort: "1025"
        ToPort: "5000"
        Description: "RPC FRS DCOM"
      - IpProtocol: "tcp"   #RPC DCOM FRS
        CidrIp: "0.0.0.0/0"
        FromPort: "49152"
        ToPort: "65535"
        Description: "RPC FRS DCOM"
      - IpProtocol: "tcp"   #RPC
        CidrIp: "0.0.0.0/0"
        FromPort: "5722"
        ToPort: "5722"
        Description: "RPC"
      - IpProtocol: "udp"   #Windows Time
        CidrIp: "0.0.0.0/0"
        FromPort: "123"
        ToPort: "123"
        Description: "NTP"
      - IpProtocol: "tcp"   #Kerberos Password MGMT
        CidrIp: "0.0.0.0/0"
        FromPort: "464"
        ToPort: "464"
        Description: "Kerberos PWS MGMT"
      - IpProtocol: "udp"   #Kerberos Password MGMT
        CidrIp: "0.0.0.0/0"
        FromPort: "464"
        ToPort: "464"
        Description: "Kerberos PWD MGMT"
      - IpProtocol: "udp"   #RPC DCOM Group Policy
        CidrIp: "0.0.0.0/0"
        FromPort: "49152"
        ToPort: "65535"
        Description: "Group Policy"
      - IpProtocol: "udp"   #DFSN, NETLOGON
        CidrIp: "0.0.0.0/0"
        FromPort: "138"
        ToPort: "138"
        Description: "Netlogon"
      - IpProtocol: "tcp"   #Kerberos Password MGMT
        CidrIp: "0.0.0.0/0"
        FromPort: "9389"
        ToPort: "9389"
        Description: "Kerberos"
      - IpProtocol: "udp"   #DHCP MADCAP
        CidrIp: "0.0.0.0/0"
        FromPort: "67"
        ToPort: "67"
        Description: "MADCAP"
      - IpProtocol: "udp"   #DHCP MADCAP
        CidrIp: "0.0.0.0/0"
        FromPort: "2535"
        ToPort: "2535"
        Description: "MADCAP"
      - IpProtocol: "udp"   #NETLOGON, NetBIOS
        CidrIp: "0.0.0.0/0"
        FromPort: "137"
        ToPort: "137"
        Description: "NetBIOS"
      - IpProtocol: "tcp"   #NetLogon
        CidrIp: "0.0.0.0/0"
        FromPort: "139"
        ToPort: "139"
        Description: "Netlogon"
      - IpProtocol: "udp"   #Kerberos
        CidrIp: "0.0.0.0/0"
        FromPort: "749"
        ToPort: "750"
        Description: "Kerberos"
      - IpProtocol: "tcp"   #Kerberos
        CidrIp: "0.0.0.0/0"
        FromPort: "749"
        ToPort: "750"
        Description: "Kerberos"
      - IpProtocol: "tcp"   #RDP
        CidrIp: "0.0.0.0/0"
        FromPort: "3389"
        ToPort: "3389"
        Description: "RDP"
      - IpProtocol: "udp"   #RDP
        CidrIp: "0.0.0.0/0"
        FromPort: "3389"
        ToPort: "3389"
        Description: "RDP"
      - IpProtocol: -1   #VPN IPs
        CidrIp: "10.21.0.0/16"
        Description: "VPN IP"
      - IpProtocol: -1   #DMZ Subnet
        CidrIp: !FindInMap [ VPCaddressPrefix,values,DMZVPCSubnet ]
        Description: "DMZ VPC"
      - IpProtocol: -1
        CidrIp: "10.8.32.0/20"
        Description: "On Prem LD5 DC"
      - IpProtocol: -1
        CidrIp: "10.8.48.0/20"
        Description: "On Prem MA4 DC"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
        FromPort: "8763"
        ToPort: "8763"
        Description: "INPRO Server"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
        FromPort: "8763"
        ToPort: "8763"
        Description: "INPRO Server"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
        FromPort: "8763"
        ToPort: "8763"
        Description: "INPRO Server"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
        FromPort: "8763"
        ToPort: "8763"
        Description: "INPRO Server"


      SecurityGroupEgress:
      - IpProtocol: -1
        CidrIp: "172.16.0.0/12"
      - IpProtocol: -1
        CidrIp: "10.0.0.0/8"
      - IpProtocol: -1
        CidrIp: "192.168.0.0/16"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
      - IpProtocol: "udp"
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "443"
        ToPort: "443"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "80"
        ToPort: "80"

  IntDNSServersSG:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue CoreNetwork-Vpc
      GroupDescription: sg for Internal DNS Servers
      Tags:
        - Key: Name
          Value: global_systems_dns_servers_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: Cluster
          Value: Global
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
      - IpProtocol: -1   #VPN IPs
        CidrIp: "10.21.0.0/16"
      - IpProtocol: -1   #DMZ Subnet
        CidrIp: !FindInMap [ VPCaddressPrefix,values,DMZVPCSubnet ]
        Description: "DMZ VPC"
      - IpProtocol: "tcp"   #Chef
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
        FromPort: "8763"
        ToPort: "8763"
        Description: "INPRO Server"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
        FromPort: "8763"
        ToPort: "8763"
        Description: "INPRO Server"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
        FromPort: "8763"
        ToPort: "8763"
        Description: "INPRO Server"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
        FromPort: "8763"
        ToPort: "8763"
        Description: "INPRO Server"
      SecurityGroupEgress:
      - IpProtocol: -1
        CidrIp: "172.16.0.0/12"
      - IpProtocol: -1
        CidrIp: "10.0.0.0/8"
      - IpProtocol: -1
        CidrIp: "192.168.0.0/16"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
      - IpProtocol: "udp"
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "443"
        ToPort: "443"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "80"
        ToPort: "80"
  ChefServersSG:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue CoreNetwork-Vpc
      GroupDescription: sg for Chef Servers
      Tags:
        - Key: Name
          Value: global_systems_chef_servers_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: Cluster
          Value: Global
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
        - IpProtocol: -1   #VPN IPs
          CidrIp: "10.21.0.0/16"
        - IpProtocol: -1   #DMZ Subnet
          CidrIp: !FindInMap [ VPCaddressPrefix,values,DMZVPCSubnet ]
          Description: "DMZ VPC"
        - IpProtocol: "tcp"   #Chef
          CidrIp: "0.0.0.0/0"
          FromPort: "443"
          ToPort: "443"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "Rundeck Automation"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "Rundeck Automation"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "BMPCS Monitoring"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "BMPCS Monitoring"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"

      SecurityGroupEgress:
        - IpProtocol: -1
          CidrIp: "172.16.0.0/12"
        - IpProtocol: -1
          CidrIp: "10.0.0.0/8"
        - IpProtocol: -1
          CidrIp: "192.168.0.0/16"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "53"
          ToPort: "53"
        - IpProtocol: "udp"
          CidrIp: "0.0.0.0/0"
          FromPort: "53"
          ToPort: "53"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "443"
          ToPort: "443"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "80"
          ToPort: "80"
  SnowdiscSG:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue CoreNetwork-Vpc
      GroupDescription: sg for SNOW Discovery Servers
      Tags:
        - Key: Name
          Value: global_systems_snowdisc_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: Cluster
          Value: Global
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
        - IpProtocol: -1   #VPN IPs
          CidrIp: "10.21.0.0/16"
        - IpProtocol: -1   #DMZ Subnet
          CidrIp: !FindInMap [ VPCaddressPrefix,values,DMZVPCSubnet ]
          Description: "DMZ VPC"
        - IpProtocol: -1   #Core Subnet
          CidrIp: !FindInMap [ VPCaddressPrefix,values,CoreVPCSubnet ]
          Description: "Core VPC"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "Rundeck Automation"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "Rundeck Automation"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "BMPCS Monitoring"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "BMPCS Monitoring"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server" 

      SecurityGroupEgress:
        - IpProtocol: -1
          CidrIp: "172.16.0.0/12"
        - IpProtocol: -1
          CidrIp: "10.0.0.0/8"
        - IpProtocol: -1
          CidrIp: "192.168.0.0/16"
        - IpProtocol: -1
          CidrIp: "216.20.244.0/24"
        - IpProtocol: -1
          CidrIp: "216.20.248.0/24"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "53"
          ToPort: "53"
        - IpProtocol: "udp"
          CidrIp: "0.0.0.0/0"
          FromPort: "53"
          ToPort: "53"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "443"
          ToPort: "443"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "80"
          ToPort: "80"
  NWRadiusSG:
      Type: 'AWS::EC2::SecurityGroup'
      Properties:
        VpcId: !ImportValue CoreNetwork-Vpc
        GroupDescription: sg for Network Radius Servers
        Tags:
          - Key: Name
            Value: global_systems_nwradius_sg
          - Key: DeviceType
            Value: Network Security Group
          - Key: Cluster
            Value: Global
          - Key: InfrastructureOwner
            Value: Network Teams
          - Key: ApplicationOwner
            Value: Network Teams
          - Key: Product
            Value: SecurityGroup
        SecurityGroupIngress:
          - IpProtocol: -1   #VPN IPs
            CidrIp: 10.21.0.0/16
          - IpProtocol: -1   #DMZ Subnet
            CidrIp: !FindInMap [ VPCaddressPrefix,values,DMZVPCSubnet ]
            Description: "DMZ VPC"
          - IpProtocol: -1   #Az1 Management Subnet
            CidrIp: !FindInMap [ VPCaddressPrefix,values,Az1ManagementSubnet ]
            Description: "Core VPC Az1 Management Subnet"
          - IpProtocol: -1   #Az2 Management Subnet
            CidrIp: !FindInMap [ VPCaddressPrefix,values,Az2ManagementSubnet ]
            Description: "Core VPC Az2 Management Subnet"                
          - IpProtocol: -1   #Security VPC
            CidrIp: "10.232.200.0/24"
            Description: "Security VPC"
          - IpProtocol: -1
            CidrIp: "10.8.32.0/20"
            Description: "On Prem LD5 DC"
          - IpProtocol: -1
            CidrIp: "10.8.48.0/20"
            Description: "On Prem MA4 DC"
          - IpProtocol: "tcp"
            CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
            FromPort: "5985"
            ToPort: "5986"
            Description: "Rundeck Automation"
          - IpProtocol: "udp"
            CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
            FromPort: "5985"
            ToPort: "5986"
            Description: "Rundeck Automation"
          - IpProtocol: "tcp"
            CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
            FromPort: "5985"
            ToPort: "5986"
            Description: "BMPCS Monitoring"
          - IpProtocol: "udp"
            CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
            FromPort: "5985"
            ToPort: "5986"
            Description: "BMPCS Monitoring"
          - IpProtocol: "tcp"
            CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
            FromPort: "8763"
            ToPort: "8763"
            Description: "INPRO Server"
          - IpProtocol: "udp"
            CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
            FromPort: "8763"
            ToPort: "8763"
            Description: "INPRO Server"
          - IpProtocol: "tcp"
            CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
            FromPort: "8763"
            ToPort: "8763"
            Description: "INPRO Server"
          - IpProtocol: "udp"
            CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
            FromPort: "8763"
            ToPort: "8763"
            Description: "INPRO Server"

        SecurityGroupEgress:
          - IpProtocol: -1
            CidrIp: "172.16.0.0/12"
          - IpProtocol: -1
            CidrIp: "10.0.0.0/8"
          - IpProtocol: -1
            CidrIp: "192.168.0.0/16"
          - IpProtocol: "tcp"
            CidrIp: "0.0.0.0/0"
            FromPort: "53"
            ToPort: "53"
          - IpProtocol: "udp"
            CidrIp: "0.0.0.0/0"
            FromPort: "53"
            ToPort: "53"
          - IpProtocol: "tcp"
            CidrIp: "0.0.0.0/0"
            FromPort: "443"
            ToPort: "443"
          - IpProtocol: "tcp"
            CidrIp: "0.0.0.0/0"
            FromPort: "80"
            ToPort: "80"

  JumpServersSG:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue CoreNetwork-Vpc
      GroupDescription: sg for Jump Servers
      Tags:
        - Key: Name
          Value: global_tools_jump_servers_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: Cluster
          Value: Global
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
        - IpProtocol: -1   #VPN IPs
          CidrIp: 10.21.0.0/16
        - IpProtocol: -1   #DMZ Subnet
          CidrIp: !FindInMap [ VPCaddressPrefix,values,DMZVPCSubnet ]
          Description: "DMZ VPC"
        - IpProtocol: -1
          CidrIp: "10.8.32.0/20"
          Description: "On Prem LD5 DC"
        - IpProtocol: -1
          CidrIp: "10.8.48.0/20"
          Description: "On Prem MA4 DC"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "Rundeck Automation"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "Rundeck Automation"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "BMPCS Monitoring"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "BMPCS Monitoring"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"   

      SecurityGroupEgress:
        - IpProtocol: -1
          CidrIp: "172.16.0.0/12"
        - IpProtocol: -1
          CidrIp: "10.0.0.0/8"
        - IpProtocol: -1
          CidrIp: "192.168.0.0/16"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "53"
          ToPort: "53"
        - IpProtocol: "udp"
          CidrIp: "0.0.0.0/0"
          FromPort: "53"
          ToPort: "53"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "443"
          ToPort: "443"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "80"
          ToPort: "80"

  BidServersSG:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue CoreNetwork-Vpc
      GroupDescription: sg for BID Servers
      Tags:
        - Key: Name
          Value: global_systems_bid_servers_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: Cluster
          Value: Global
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
        - IpProtocol: "tcp"   #msrpc
          CidrIp: "0.0.0.0/0"
          FromPort: "135"
          ToPort: "135"
        - IpProtocol: "tcp"   #MSSQL
          CidrIp: "0.0.0.0/0"
          FromPort: "1433"
          ToPort: "1433"
          Description: "SQL"
        - IpProtocol: "tcp"   #SMB
          CidrIp: "0.0.0.0/0"
          FromPort: "445"
          ToPort: "445"
          Description: "SMB"
        - IpProtocol: "tcp"   #WMI
          CidrIp: "0.0.0.0/0"
          FromPort: "49154"
          ToPort: "49154"
          Description: "WMI"
        - IpProtocol: -1   #VPN IPs
          CidrIp: 10.21.0.0/16
        - IpProtocol: -1   #DMZ Subnet
          CidrIp: !FindInMap [ VPCaddressPrefix,values,DMZVPCSubnet ]
          Description: "DMZ VPC"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "Rundeck Automation"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "Rundeck Automation"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "BMPCS Monitoring"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "BMPCS Monitoring"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"

      SecurityGroupEgress:
        - IpProtocol: -1
          CidrIp: "172.16.0.0/12"
        - IpProtocol: -1
          CidrIp: "10.0.0.0/8"
        - IpProtocol: -1
          CidrIp: "192.168.0.0/16"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "53"
          ToPort: "53"
        - IpProtocol: "udp"
          CidrIp: "0.0.0.0/0"
          FromPort: "53"
          ToPort: "53"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "443"
          ToPort: "443"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "80"
          ToPort: "80"
        - IpProtocol: "tcp"   #SES
          CidrIp: "0.0.0.0/0"
          FromPort: "587"
          ToPort: "587"  
  ASRServersSG:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue VoiceNetwork-Vpc
      GroupDescription: sg for ASR Servers
      Tags:
        - Key: Name
          Value: global_systems_asr_servers_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: Cluster
          Value: Global
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
        - IpProtocol: -1   #VPN IPs
          CidrIp: 10.21.0.0/16
        - IpProtocol: -1   #DMZ Subnet
          CidrIp: !FindInMap [ VPCaddressPrefix,values,DMZVPCSubnet ]
          Description: "DMZ VPC"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "8010"
          ToPort: "8010"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "8929"
          ToPort: "8929"
        - IpProtocol: -1
          CidrIp: !FindInMap [ VPCaddressPrefix,values,VoiceNetwork1Trust ]
        - IpProtocol: -1
          CidrIp: !FindInMap [ VPCaddressPrefix,values,VoiceNetwork2Trust ]
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "Rundeck Automation"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "Rundeck Automation"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "BMPCS Monitoring"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "BMPCS Monitoring"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
      SecurityGroupEgress:
        - IpProtocol: -1
          CidrIp: "172.16.0.0/12"
        - IpProtocol: -1
          CidrIp: "10.0.0.0/8"
        - IpProtocol: -1
          CidrIp: "192.168.0.0/16"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "53"
          ToPort: "53"
        - IpProtocol: "udp"
          CidrIp: "0.0.0.0/0"
          FromPort: "53"
          ToPort: "53"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "443"
          ToPort: "443"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "80"
          ToPort: "80"

  TTSServersSG:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue VoiceNetwork-Vpc
      GroupDescription: sg for TTS Servers
      Tags:
        - Key: Name
          Value: global_systems_tts_servers_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: Cluster
          Value: Global
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
        - IpProtocol: -1   #VPN IPs
          CidrIp: "10.21.0.0/16"
        - IpProtocol: -1   #DMZ Subnet
          CidrIp: !FindInMap [ VPCaddressPrefix,values,DMZVPCSubnet ]
          Description: "DMZ VPC"
        - IpProtocol: -1
          CidrIp: !FindInMap [ VPCaddressPrefix,values,VoiceNetwork1Trust ]
        - IpProtocol: -1
          CidrIp: !FindInMap [ VPCaddressPrefix,values,VoiceNetwork2Trust ]
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "Rundeck Automation"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "Rundeck Automation"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "BMPCS Monitoring"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "BMPCS Monitoring"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"

      SecurityGroupEgress:
        - IpProtocol: -1
          CidrIp: "172.16.0.0/12"
        - IpProtocol: -1
          CidrIp: "10.0.0.0/8"
        - IpProtocol: -1
          CidrIp: "192.168.0.0/16"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "53"
          ToPort: "53"
        - IpProtocol: "udp"
          CidrIp: "0.0.0.0/0"
          FromPort: "53"
          ToPort: "53"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "443"
          ToPort: "443"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "80"
          ToPort: "80"

  COMServersSG:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue VoiceNetwork-Vpc
      GroupDescription: sg for COM Servers
      Tags:
        - Key: Name
          Value: global_systems_com_servers_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: Cluster
          Value: Global
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
        - IpProtocol: -1   #VPN IPs
          CidrIp: 10.21.0.0/16
        - IpProtocol: -1   #DMZ Subnet
          CidrIp: !FindInMap [ VPCaddressPrefix,values,DMZVPCSubnet ]
          Description: "DMZ VPC"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "8010"
          ToPort: "8010"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "8929"
          ToPort: "8929"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "Rundeck Automation"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "Rundeck Automation"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "BMPCS Monitoring"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "BMPCS Monitoring"

      SecurityGroupEgress:
        - IpProtocol: -1
          CidrIp: "172.16.0.0/12"
        - IpProtocol: -1
          CidrIp: "10.0.0.0/8"
        - IpProtocol: -1
          CidrIp: "192.168.0.0/16"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "53"
          ToPort: "53"
        - IpProtocol: "udp"
          CidrIp: "0.0.0.0/0"
          FromPort: "53"
          ToPort: "53"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "443"
          ToPort: "443"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "80"
          ToPort: "80"


  VPC2ASRServersSG:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue VoiceNetwork2-Vpc
      GroupDescription: sg for ASR Servers
      Tags:
        - Key: Name
          Value: global_systems_asr_servers_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: Cluster
          Value: Global
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
      - IpProtocol: -1   #VPN IPs
        CidrIp: "10.21.0.0/16"
      - IpProtocol: -1   #DMZ Subnet
        CidrIp: !FindInMap [ VPCaddressPrefix,values,DMZVPCSubnet ]
        Description: "DMZ VPC"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "8010"
        ToPort: "8010"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "8929"
        ToPort: "8929"
      - IpProtocol: -1
        CidrIp: !FindInMap [ VPCaddressPrefix,values,VoiceNetwork1Trust ]
      - IpProtocol: -1
        CidrIp: !FindInMap [ VPCaddressPrefix,values,VoiceNetwork2Trust ]
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"


      SecurityGroupEgress:
      - IpProtocol: -1
        CidrIp: "172.16.0.0/12"
      - IpProtocol: -1
        CidrIp: "10.0.0.0/8"
      - IpProtocol: -1
        CidrIp: "192.168.0.0/16"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
      - IpProtocol: "udp"
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "443"
        ToPort: "443"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "80"
        ToPort: "80"

  VPC2TTSServersSG:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue VoiceNetwork2-Vpc
      GroupDescription: sg for TTS Servers
      Tags:
        - Key: Name
          Value: global_systems_tts_servers_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: Cluster
          Value: Global
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
      - IpProtocol: -1   #VPN IPs
        CidrIp: 10.21.0.0/16
      - IpProtocol: -1   #DMZ Subnet
        CidrIp: !FindInMap [ VPCaddressPrefix,values,DMZVPCSubnet ]
        Description: "DMZ VPC"
      - IpProtocol: -1
        CidrIp: !FindInMap [ VPCaddressPrefix,values,VoiceNetwork1Trust ]
      - IpProtocol: -1
        CidrIp: !FindInMap [ VPCaddressPrefix,values,VoiceNetwork2Trust ]
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
        FromPort: "8763"
        ToPort: "8763"
        Description: "INPRO Server"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
        FromPort: "8763"
        ToPort: "8763"
        Description: "INPRO Server"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
        FromPort: "8763"
        ToPort: "8763"
        Description: "INPRO Server"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
        FromPort: "8763"
        ToPort: "8763"
        Description: "INPRO Server"

      SecurityGroupEgress:
      - IpProtocol: -1
        CidrIp: "172.16.0.0/12"
      - IpProtocol: -1
        CidrIp: "10.0.0.0/8"
      - IpProtocol: -1
        CidrIp: "192.168.0.0/16"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
      - IpProtocol: "udp"
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "443"
        ToPort: "443"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "80"
        ToPort: "80"

  VPC2COMServersSG:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue VoiceNetwork2-Vpc
      GroupDescription: sg for COM Servers
      Tags:
        - Key: Name
          Value: global_systems_com_servers_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: Cluster
          Value: Global
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
        - IpProtocol: -1   #VPN IPs
          CidrIp: 10.21.0.0/16
        - IpProtocol: -1   #DMZ Subnet
          CidrIp: !FindInMap [ VPCaddressPrefix,values,DMZVPCSubnet ]
          Description: "DMZ VPC"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "8010"
          ToPort: "8010"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "8929"
          ToPort: "8929"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "Rundeck Automation"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "Rundeck Automation"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "BMPCS Monitoring"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "BMPCS Monitoring"
      SecurityGroupEgress:
        - IpProtocol: -1
          CidrIp: "172.16.0.0/12"
        - IpProtocol: -1
          CidrIp: "10.0.0.0/8"
        - IpProtocol: -1
          CidrIp: "192.168.0.0/16"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "53"
          ToPort: "53"
        - IpProtocol: "udp"
          CidrIp: "0.0.0.0/0"
          FromPort: "53"
          ToPort: "53"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "443"
          ToPort: "443"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "80"
          ToPort: "80"


  FTPINTServersSG:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue CoreNetwork-Vpc
      GroupDescription: sg for FTP Internal Servers
      Tags:
        - Key: Name
          Value: global_systems_ftp_int_servers_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: Cluster
          Value: Global
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
      - IpProtocol: -1   #VPN IPs
        CidrIp: 10.21.0.0/16
      - IpProtocol: -1   #DMZ Subnet
        CidrIp: !FindInMap [ VPCaddressPrefix,values,DMZVPCSubnet ]
        Description: "DMZ VPC"
      - IpProtocol: -1  #FTP
        CidrIp: "0.0.0.0/0"
        FromPort: "21"
        ToPort: "22"
      - IpProtocol: -1 #FTP
        CidrIp: "0.0.0.0/0"
        FromPort: "445"
        ToPort: "445"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"

      SecurityGroupEgress:
      - IpProtocol: -1
        CidrIp: "172.16.0.0/12"
      - IpProtocol: -1
        CidrIp: "10.0.0.0/8"
      - IpProtocol: -1
        CidrIp: "192.168.0.0/16"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
      - IpProtocol: "udp"
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "443"
        ToPort: "443"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "80"
        ToPort: "80"

  SophosServersSG:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue CoreNetwork-Vpc
      GroupDescription: sg for Sophos Servers
      Tags:
        - Key: Name
          Value: global_tools_sophos_servers_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: Cluster
          Value: Global
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
      - IpProtocol: -1   #VPN IPs
        CidrIp: 10.21.0.0/16
      - IpProtocol: -1   #DMZ Subnet
        CidrIp: !FindInMap [ VPCaddressPrefix,values,DMZVPCSubnet ]
        Description: "DMZ VPC"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "8192"
        ToPort: "8194"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "5007"
        ToPort: "5007"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "445"
        ToPort: "445"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "443"
        ToPort: "443"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"


      SecurityGroupEgress:
      - IpProtocol: -1
        CidrIp: "172.16.0.0/12"
      - IpProtocol: -1
        CidrIp: "10.0.0.0/8"
      - IpProtocol: -1
        CidrIp: "192.168.0.0/16"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
      - IpProtocol: "udp"
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "443"
        ToPort: "443"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "80"
        ToPort: "80"
  MailDirectorServersSG:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue CoreNetwork-Vpc
      GroupDescription: sg for Mail Director Servers
      Tags:
        - Key: Name
          Value: global_systems_mdr_servers_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: Cluster
          Value: Global
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
      - IpProtocol: -1   #VPN IPs
        CidrIp: 10.21.0.0/16
      - IpProtocol: -1   #DMZ Subnet
        CidrIp: !FindInMap [ VPCaddressPrefix,values,DMZVPCSubnet ]
        Description: "DMZ VPC"
      - IpProtocol: "tcp"
        CidrIp: 0.0.0.0/0
        FromPort: "25"
        ToPort: "25"
        Description: "SMTP"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"

      SecurityGroupEgress:
      - IpProtocol: -1
        CidrIp: "172.16.0.0/12"
      - IpProtocol: -1
        CidrIp: "10.0.0.0/8"
      - IpProtocol: -1
        CidrIp: "192.168.0.0/16"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
      - IpProtocol: "udp"
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "443"
        ToPort: "443"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "80"
        ToPort: "80"
  BMINTServersSG:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue CoreNetwork-Vpc
      GroupDescription: sg for BMINT Servers
      Tags:
        - Key: Name
          Value: global_tools_BMINT_servers_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: Cluster
          Value: Global
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
      - IpProtocol: -1   #VPN IPs
        CidrIp: 10.21.0.0/16
      - IpProtocol: -1   #DMZ Subnet
        CidrIp: !FindInMap [ VPCaddressPrefix,values,DMZVPCSubnet ]
        Description: "DMZ VPC"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "3183"
        ToPort: "3183"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "3184"
        ToPort: "3184"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "162"
        ToPort: "162"
      - IpProtocol: "udp"
        CidrIp: "0.0.0.0/0"
        FromPort: "162"
        ToPort: "162"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
        FromPort: "8763"
        ToPort: "8763"
        Description: "INPRO Server"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
        FromPort: "8763"
        ToPort: "8763"
        Description: "INPRO Server"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
        FromPort: "8763"
        ToPort: "8763"
        Description: "INPRO Server"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
        FromPort: "8763"
        ToPort: "8763"
        Description: "INPRO Server"

      SecurityGroupEgress:
      - IpProtocol: -1
        CidrIp: "172.16.0.0/12"
      - IpProtocol: -1
        CidrIp: "10.0.0.0/8"
      - IpProtocol: -1
        CidrIp: "192.168.0.0/16"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
      - IpProtocol: "udp"
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "443"
        ToPort: "443"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "80"
        ToPort: "80"
  BMCMonitoringServerSG:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue CoreNetwork-Vpc
      GroupDescription: sg for BMC Monitoring Server
      Tags:
        - Key: Name
          Value: global_tools_BMCMonitoring_server_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: Cluster
          Value: Global
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
      - IpProtocol: -1   #VPN IPs
        CidrIp: 10.21.0.0/16
      - IpProtocol: -1   #DMZ Subnet
        CidrIp: !FindInMap [ VPCaddressPrefix,values,DMZVPCSubnet ]
        Description: "DMZ VPC"
      - IpProtocol: -1   #Core Subnet
        CidrIp: !FindInMap [ VPCaddressPrefix,values,CoreVPCSubnet ]
        Description: "Core VPC"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "3183"
        ToPort: "3183"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "3184"
        ToPort: "3184"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "162"
        ToPort: "162"
      - IpProtocol: "udp"
        CidrIp: "0.0.0.0/0"
        FromPort: "162"
        ToPort: "162"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"

      SecurityGroupEgress:
      - IpProtocol: -1
        CidrIp: "172.16.0.0/12"
      - IpProtocol: -1
        CidrIp: "10.0.0.0/8"
      - IpProtocol: -1
        CidrIp: "192.168.0.0/16"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
      - IpProtocol: "udp"
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "443"
        ToPort: "443"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "80"
        ToPort: "80"
  BMPCSServersSG:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue CoreNetwork-Vpc
      GroupDescription: sg for BMPCS Servers
      Tags:
        - Key: Name
          Value: global_tools_BMPCS_servers_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: Cluster
          Value: Global
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
      - IpProtocol: -1   #VPN IPs
        CidrIp: 10.21.0.0/16
      - IpProtocol: -1   #DMZ Subnet
        CidrIp: !FindInMap [ VPCaddressPrefix,values,DMZVPCSubnet ]
        Description: "DMZ VPC"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "2059"
        ToPort: "2059"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"

      SecurityGroupEgress:
      - IpProtocol: -1
        CidrIp: "172.16.0.0/12"
      - IpProtocol: -1
        CidrIp: "10.0.0.0/8"
      - IpProtocol: -1
        CidrIp: "192.168.0.0/16"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
      - IpProtocol: "udp"
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "443"
        ToPort: "443"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "80"
        ToPort: "80"

  BMCCapacityServerSG:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue CoreNetwork-Vpc
      GroupDescription: sg for BMC Capacity Server
      Tags:
        - Key: Name
          Value: global_tools_BMCCapacity_server_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: Cluster
          Value: Global
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
      - IpProtocol: -1   #VPN IPs
        CidrIp: 10.21.0.0/16
      - IpProtocol: -1   #DMZ Subnet
        CidrIp: !FindInMap [ VPCaddressPrefix,values,DMZVPCSubnet ]
        Description: "DMZ VPC"
      - IpProtocol: -1   #Core Subnet
        CidrIp: !FindInMap [ VPCaddressPrefix,values,CoreVPCSubnet ]
        Description: "Core VPC"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "3183"
        ToPort: "3183"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "3184"
        ToPort: "3184"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "162"
        ToPort: "162"
      - IpProtocol: "udp"
        CidrIp: "0.0.0.0/0"
        FromPort: "162"
        ToPort: "162"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
        FromPort: "8763"
        ToPort: "8763"
        Description: "INPRO Server"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
        FromPort: "8763"
        ToPort: "8763"
        Description: "INPRO Server"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
        FromPort: "8763"
        ToPort: "8763"
        Description: "INPRO Server"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
        FromPort: "8763"
        ToPort: "8763"
        Description: "INPRO Server"

      SecurityGroupEgress:
      - IpProtocol: -1
        CidrIp: "172.16.0.0/12"
      - IpProtocol: -1
        CidrIp: "10.0.0.0/8"
      - IpProtocol: -1
        CidrIp: "192.168.0.0/16"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
      - IpProtocol: "udp"
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "443"
        ToPort: "443"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "80"
        ToPort: "80"

  WSUSServersSG:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue CoreNetwork-Vpc
      GroupDescription: sg for WSUS Servers
      Tags:
        - Key: Name
          Value: global_tools_WSUS_servers_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: Cluster
          Value: Global
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
      - IpProtocol: -1   #VPN IPs
        CidrIp: 10.21.0.0/16
      - IpProtocol: -1   #DMZ Subnet
        CidrIp: !FindInMap [ VPCaddressPrefix,values,DMZVPCSubnet ]
        Description: "DMZ VPC"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "443"
        ToPort: "443"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "8530"
        ToPort: "8531"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "80"
        ToPort: "80"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
        FromPort: "8763"
        ToPort: "8763"
        Description: "INPRO Server"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
        FromPort: "8763"
        ToPort: "8763"
        Description: "INPRO Server"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
        FromPort: "8763"
        ToPort: "8763"
        Description: "INPRO Server"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
        FromPort: "8763"
        ToPort: "8763"
        Description: "INPRO Server"

      SecurityGroupEgress:
      - IpProtocol: -1
        CidrIp: "172.16.0.0/12"
      - IpProtocol: -1
        CidrIp: "10.0.0.0/8"
      - IpProtocol: -1
        CidrIp: "192.168.0.0/16"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
      - IpProtocol: "udp"
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "443"
        ToPort: "443"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "80"
        ToPort: "80"
  DBMonServersSG:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue CoreNetwork-Vpc
      GroupDescription: sg for DBMon Servers
      Tags:
        - Key: Name
          Value: global_systems_DBMon_servers_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: Cluster
          Value: Global
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
      - IpProtocol: -1   #VPN IPs
        CidrIp: 10.21.0.0/16
      - IpProtocol: -1   #DMZ Subnet
        CidrIp: !FindInMap [ VPCaddressPrefix,values,DMZVPCSubnet ]
        Description: "DMZ VPC"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "1433"
        ToPort: "1434"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "1450"
        ToPort: "1450"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "445"
        ToPort: "445"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
        FromPort: "8763"
        ToPort: "8763"
        Description: "INPRO Server"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
        FromPort: "8763"
        ToPort: "8763"
        Description: "INPRO Server"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
        FromPort: "8763"
        ToPort: "8763"
        Description: "INPRO Server"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
        FromPort: "8763"
        ToPort: "8763"
        Description: "INPRO Server"

      SecurityGroupEgress:
      - IpProtocol: -1
        CidrIp: "172.16.0.0/12"
      - IpProtocol: -1
        CidrIp: "10.0.0.0/8"
      - IpProtocol: -1
        CidrIp: "192.168.0.0/16"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
      - IpProtocol: "udp"
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "443"
        ToPort: "443"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "80"
        ToPort: "80"
      - IpProtocol: "tcp"   #SES
        CidrIp: "0.0.0.0/0"
        FromPort: "587"
        ToPort: "587"  
  GlobalDBServersSG:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue CoreNetwork-Vpc
      GroupDescription: sg for globaldb Servers
      Tags:
        - Key: Name
          Value: global_systems_globaldb_servers_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: Cluster
          Value: Global
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
        - IpProtocol: -1   #VPN IPs
          CidrIp: 10.21.0.0/16
        - IpProtocol: -1   #DMZ Subnet
          CidrIp: !FindInMap [ VPCaddressPrefix,values,DMZVPCSubnet ]
          Description: "DMZ VPC"
        - IpProtocol: -1   #Core Subnet
          CidrIp: !FindInMap [ VPCaddressPrefix,values,CoreVPCSubnet ]
          Description: "Core VPC"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "445"
          ToPort: "445"
        - IpProtocol: "tcp"
          CidrIp: "10.225.0.0/18"
          FromPort: "1433"
          ToPort: "1433"
          Description: "WFO to Cumulus"
        - IpProtocol: "tcp"
          CidrIp: "10.232.160.0/23"
          FromPort: "1433"
          ToPort: "1433"
          Description: "Shared EKS to Cumulus"
        - IpProtocol: "tcp"
          CidrIp: "10.232.162.0/23"
          FromPort: "1433"
          ToPort: "1433"
          Description: "Shared EKS to Cumulus"
        - IpProtocol: "tcp"
          CidrIp: "10.232.164.0/23"
          FromPort: "1433"
          ToPort: "1433"
          Description: "Shared EKS to Cumulus"
        - IpProtocol: "icmp"
          CidrIp: "10.232.160.0/23"
          FromPort: "-1"
          ToPort: "-1"
          Description: "Shared EKS to Cumulus"
        - IpProtocol: "icmp"
          CidrIp: "10.232.162.0/23"
          FromPort: "-1"
          ToPort: "-1"
          Description: "Shared EKS to Cumulus"
        - IpProtocol: "icmp"
          CidrIp: "10.232.164.0/23"
          FromPort: "-1"
          ToPort: "-1"
          Description: "Shared EKS to Cumulus"
        - IpProtocol: "tcp"
          CidrIp: "10.8.42.181/32"
          FromPort: "1433"
          ToPort: "1433"
          Description: "Witness Server ukld5-indbw01"
        - IpProtocol: "tcp"
          CidrIp: "10.8.42.181/32"
          FromPort: "5022"
          ToPort: "5022"
          Description: "Witness Server ukld5-indbw01"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "Rundeck Automation"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "Rundeck Automation"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "BMPCS Monitoring"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "BMPCS Monitoring"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
      SecurityGroupEgress:
        - IpProtocol: -1
          CidrIp: "172.16.0.0/12"
        - IpProtocol: -1
          CidrIp: "10.0.0.0/8"
        - IpProtocol: -1
          CidrIp: "192.168.0.0/16"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "53"
          ToPort: "53"
        - IpProtocol: "udp"
          CidrIp: "0.0.0.0/0"
          FromPort: "53"
          ToPort: "53"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "443"
          ToPort: "443"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "80"
          ToPort: "80"
        - IpProtocol: "tcp"   #SES
          CidrIp: "0.0.0.0/0"
          FromPort: "587"
          ToPort: "587"  
  InlogServersSG:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue CoreNetwork-Vpc
      GroupDescription: sg for Inlog Servers
      Tags:
        - Key: Name
          Value: global_tools_Inlog_servers_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: Cluster
          Value: Global
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
      - IpProtocol: -1   #VPN IPs
        CidrIp: 10.21.0.0/16
        Description: "GP VPN"
      - IpProtocol: -1   #DMZ Subnet
        CidrIp: !FindInMap [ VPCaddressPrefix,values,DMZVPCSubnet ]
        Description: "DMZ VPC"
      - IpProtocol: "udp"
        CidrIp: "0.0.0.0/0"
        FromPort: "514"
        ToPort: "514"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "445"
        ToPort: "445"
      - IpProtocol: -1
        CidrIp: "10.8.32.0/20"
        Description: "On Prem LD5 DC"
      - IpProtocol: -1
        CidrIp: "10.8.48.0/20"
        Description: "On Prem MA4 DC"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
        FromPort: "8763"
        ToPort: "8763"
        Description: "INPRO Server"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
        FromPort: "8763"
        ToPort: "8763"
        Description: "INPRO Server"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
        FromPort: "8763"
        ToPort: "8763"
        Description: "INPRO Server"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
        FromPort: "8763"
        ToPort: "8763"
        Description: "INPRO Server"

      SecurityGroupEgress:
      - IpProtocol: -1
        CidrIp: "172.16.0.0/12"
      - IpProtocol: -1
        CidrIp: "10.0.0.0/8"
      - IpProtocol: -1
        CidrIp: "192.168.0.0/16"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
      - IpProtocol: "udp"
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "443"
        ToPort: "443"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "80"
        ToPort: "80"
  InCDRServersSG:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue CoreNetwork-Vpc
      GroupDescription: sg for InCDR Servers
      Tags:
        - Key: Name
          Value: global_tools_InCDR_servers_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: Cluster
          Value: Global
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
      - IpProtocol: -1   #VPN IPs
        CidrIp: 10.21.0.0/16
      - IpProtocol: -1   #DMZ Subnet
        CidrIp: !FindInMap [ VPCaddressPrefix,values,DMZVPCSubnet ]
        Description: "DMZ VPC"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
        FromPort: "8763"
        ToPort: "8763"
        Description: "INPRO Server"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
        FromPort: "8763"
        ToPort: "8763"
        Description: "INPRO Server"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
        FromPort: "8763"
        ToPort: "8763"
        Description: "INPRO Server"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
        FromPort: "8763"
        ToPort: "8763"
        Description: "INPRO Server"

      SecurityGroupEgress:
      - IpProtocol: -1
        CidrIp: "172.16.0.0/12"
      - IpProtocol: -1
        CidrIp: "10.0.0.0/8"
      - IpProtocol: -1
        CidrIp: "192.168.0.0/16"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
      - IpProtocol: "udp"
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "443"
        ToPort: "443"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "80"
        ToPort: "80"

  NWFMServersSG:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue CoreNetwork-Vpc
      GroupDescription: sg for NWFM Servers
      Tags:
        - Key: Name
          Value: global_network_NWFM_servers_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: Cluster
          Value: Global
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
      - IpProtocol: -1   #VPN IPs
        CidrIp: 10.21.0.0/16
      - IpProtocol: -1   #DMZ Subnet
        CidrIp: !FindInMap [ VPCaddressPrefix,values,DMZVPCSubnet ]
        Description: "DMZ VPC"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"

      SecurityGroupEgress:
      - IpProtocol: -1
        CidrIp: "172.16.0.0/12"
      - IpProtocol: -1
        CidrIp: "10.0.0.0/8"
      - IpProtocol: -1
        CidrIp: "192.168.0.0/16"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
      - IpProtocol: "udp"
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "443"
        ToPort: "443"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "80"
        ToPort: "80"
  GlobalWebServersSG:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue DMZNetwork-Vpc
      GroupDescription: sg for Global Web Servers
      Tags:
        - Key: Name
          Value: global_systems_web_servers_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: Cluster
          Value: Global
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
        - IpProtocol: -1   #VPN IPs
          CidrIp: 10.21.0.0/16
        - IpProtocol: -1   #AWS Core VPC
          CidrIp: !FindInMap [ VPCaddressPrefix,values,CoreVPCSubnet ]
        - IpProtocol: -1   #AWS DMZ VPC
          CidrIp: !FindInMap [ VPCaddressPrefix,values,DMZVPCSubnet ]       
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "Rundeck Automation"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "Rundeck Automation"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "BMPCS Monitoring"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "BMPCS Monitoring"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
      SecurityGroupEgress:
        - IpProtocol: -1
          CidrIp: "172.16.0.0/12"
        - IpProtocol: -1
          CidrIp: "192.168.0.0/16"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "53"
          ToPort: "53"
        - IpProtocol: "udp"
          CidrIp: "0.0.0.0/0"
          FromPort: "53"
          ToPort: "53"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "443"
          ToPort: "443"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "21"
          ToPort: "22"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "80"
          ToPort: "80"
        - IpProtocol: -1   #AWS Core VPC
          CidrIp: !FindInMap [ VPCaddressPrefix,values,CoreVPCSubnet ]

  CostGuardWebServiceServerSG:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue DMZNetwork-Vpc
      GroupDescription: sg for CostGuardWebService Server
      Tags:
        - Key: Name
          Value: CostGuardWebService_server_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: Cluster
          Value: Global
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
        - IpProtocol: -1   #AWS Core VPC
          CidrIp: !FindInMap [ VPCaddressPrefix,values,CoreVPCSubnet ]
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"  

      SecurityGroupEgress:
        - IpProtocol: -1
          CidrIp: "172.16.0.0/12"
        - IpProtocol: -1
          CidrIp: "10.0.0.0/8"
        - IpProtocol: -1
          CidrIp: "192.168.0.0/16"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "53"
          ToPort: "53"
        - IpProtocol: "udp"
          CidrIp: "0.0.0.0/0"
          FromPort: "53"
          ToPort: "53"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "443"
          ToPort: "443"

#Nesting
  CostGuardWebServiceServerSGSelfRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref CostGuardWebServiceServerSG
      IpProtocol: -1   #Self Rule
      SourceSecurityGroupId: !Ref CostGuardWebServiceServerSG
  CostGuardWebServiceServerSGDMZLoadBalancerRuleIn:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref CostGuardWebServiceServerSG
      IpProtocol: -1   #Internal Cluster
      SourceSecurityGroupId: !Ref ClusterALBSecurityGroup



  InternalGlobalWebServersSG:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue CoreNetwork-Vpc
      GroupDescription: sg for Internal Web Servers
      Tags:
        - Key: Name
          Value: global_systems_internal_web_servers_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: Cluster
          Value: Global
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
        - IpProtocol: -1   #VPN IPs
          CidrIp: 10.21.0.0/16
        - IpProtocol: -1   #AWS DMZ VPC
          CidrIp: !FindInMap [ VPCaddressPrefix,values,DMZVPCSubnet ]
          Description: "DMZ VPC"
        - IpProtocol: -1   #AWS Core VPC
          CidrIp: !FindInMap [ VPCaddressPrefix,values,CoreVPCSubnet ]
          Description: "Core VPC"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "Rundeck Automation"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "Rundeck Automation"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "BMPCS Monitoring"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "BMPCS Monitoring"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,SharedEKSUKSov ]
          FromPort: "80"
          ToPort: "80"
          Description: "Shared EKS for UKSov"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,SharedEKSUKSov ]
          FromPort: "443"
          ToPort: "443"
          Description: "Shared EKS for UKSov"                    

      SecurityGroupEgress:
        - IpProtocol: -1
          CidrIp: "172.16.0.0/12"
        - IpProtocol: -1
          CidrIp: "192.168.0.0/16"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "53"
          ToPort: "53"
        - IpProtocol: "udp"
          CidrIp: "0.0.0.0/0"
          FromPort: "53"
          ToPort: "53"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "443"
          ToPort: "443"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "21"
          ToPort: "22"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "80"
          ToPort: "80"
        - IpProtocol: -1   #AWS Core VPC
          CidrIp: !FindInMap [ VPCaddressPrefix,values,CoreVPCSubnet ]
        - IpProtocol: -1   #AWS DMZ VPC
          CidrIp: !FindInMap [ VPCaddressPrefix,values,DMZVPCSubnet ]
        - IpProtocol: "tcp"
          FromPort: "8915"
          ToPort: "8915"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,VoiceNetwork1Trust ]
          Description: "Voice VPC Trust Subnet"
        - IpProtocol: "tcp"
          FromPort: "8915"
          ToPort: "8915"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,VoiceNetwork2Trust ]
          Description: "Voice VPC-2 Trust Subnet"
  InternalCertificateServersSG:
      Type: 'AWS::EC2::SecurityGroup'
      Properties:
        VpcId: !ImportValue CoreNetwork-Vpc
        GroupDescription: sg for Internal Certificate Servers
        Tags:
          - Key: Name
            Value: global_systems_internal_certificate_sg
          - Key: DeviceType
            Value: Network Security Group
          - Key: Cluster
            Value: Global
          - Key: InfrastructureOwner
            Value: Network Teams
          - Key: ApplicationOwner
            Value: Network Teams
          - Key: Product
            Value: SecurityGroup
        SecurityGroupIngress:
          - IpProtocol: -1   #VPN IPs
            CidrIp: 10.21.0.0/16
          - IpProtocol: -1   #AWS DMZ VPC
            CidrIp: !FindInMap [ VPCaddressPrefix,values,DMZVPCSubnet ]
            Description: "DMZ VPC"
          - IpProtocol: "tcp"
            CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
            FromPort: "8763"
            ToPort: "8763"
            Description: "INPRO Server"
          - IpProtocol: "udp"
            CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
            FromPort: "8763"
            ToPort: "8763"
            Description: "INPRO Server"
          - IpProtocol: "tcp"
            CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
            FromPort: "8763"
            ToPort: "8763"
            Description: "INPRO Server"
          - IpProtocol: "udp"
            CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
            FromPort: "8763"
            ToPort: "8763"
            Description: "INPRO Server"  
        SecurityGroupEgress:
          - IpProtocol: -1
            CidrIp: "172.16.0.0/12"
          - IpProtocol: -1
            CidrIp: "192.168.0.0/16"
          - IpProtocol: "tcp"
            CidrIp: "0.0.0.0/0"
            FromPort: "53"
            ToPort: "53"
          - IpProtocol: "udp"
            CidrIp: "0.0.0.0/0"
            FromPort: "53"
            ToPort: "53"
          - IpProtocol: "tcp"
            CidrIp: "0.0.0.0/0"
            FromPort: "443"
            ToPort: "443"
          - IpProtocol: "tcp"
            CidrIp: "0.0.0.0/0"
            FromPort: "21"
            ToPort: "22"
          - IpProtocol: "tcp"
            CidrIp: "0.0.0.0/0"
            FromPort: "80"
            ToPort: "80"
          - IpProtocol: -1   #AWS Core VPC
            CidrIp: !FindInMap [ VPCaddressPrefix,values,CoreVPCSubnet ]
          - IpProtocol: -1   #AWS DMZ VPC
            CidrIp: !FindInMap [ VPCaddressPrefix,values,DMZVPCSubnet ]

  InFTPSGDMZ:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue DMZNetwork-Vpc
      GroupDescription: sg for InFTP Servers
      Tags:
        - Key: Name
          Value: global_systems_inftp_servers_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: Cluster
          Value: Global
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
        - IpProtocol: -1   #VPN IPs
          CidrIp: 10.21.0.0/16
        - IpProtocol: -1   #AWS Core VPC
          CidrIp: !FindInMap [ VPCaddressPrefix,values,CoreVPCSubnet ]
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "80"
          ToPort: "80"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "443"
          ToPort: "443"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "21"
          ToPort: "22"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "Rundeck Automation"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "Rundeck Automation"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "BMPCS Monitoring"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "BMPCS Monitoring"

      SecurityGroupEgress:
        - IpProtocol: -1
          CidrIp: "172.16.0.0/12"
        - IpProtocol: -1
          CidrIp: "192.168.0.0/16"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "53"
          ToPort: "53"
        - IpProtocol: "udp"
          CidrIp: "0.0.0.0/0"
          FromPort: "53"
          ToPort: "53"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "443"
          ToPort: "443"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "21"
          ToPort: "22"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "80"
          ToPort: "80"
        - IpProtocol: -1   #AWS Core VPC
          CidrIp: !FindInMap [ VPCaddressPrefix,values,CoreVPCSubnet ]


  InmailSGDMZ:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue DMZNetwork-Vpc
      GroupDescription: sg for Inmail Servers
      Tags:
        - Key: Name
          Value: global_systems_inmail_servers_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: Cluster
          Value: Global
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
        - IpProtocol: -1   #VPN IPs
          CidrIp: 10.21.0.0/16
        - IpProtocol: -1   #AWS Core VPC
          CidrIp: !FindInMap [ VPCaddressPrefix,values,CoreVPCSubnet ]
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "25"
          ToPort: "25"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "Rundeck Automation"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "Rundeck Automation"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "BMPCS Monitoring"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "BMPCS Monitoring"

      SecurityGroupEgress:
        - IpProtocol: -1
          CidrIp: "172.16.0.0/12"
        - IpProtocol: -1
          CidrIp: "192.168.0.0/16"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "53"
          ToPort: "53"
        - IpProtocol: "udp"
          CidrIp: "0.0.0.0/0"
          FromPort: "53"
          ToPort: "53"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "443"
          ToPort: "443"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "21"
          ToPort: "22"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "25"
          ToPort: "25"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "80"
          ToPort: "80"
        - IpProtocol: -1   #AWS Core VPC
          CidrIp: !FindInMap [ VPCaddressPrefix,values,CoreVPCSubnet ]
  RLRServersSG:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue VoiceNetwork-Vpc
      GroupDescription: sg for RLR Servers
      Tags:
        - Key: Name
          Value: global_systems_RLR_servers_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: Cluster
          Value: Global
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
        - IpProtocol: -1   #VPN IPs
          CidrIp: 10.21.0.0/16
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "25"
          ToPort: "25"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "Rundeck Automation"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "Rundeck Automation"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "BMPCS Monitoring"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "BMPCS Monitoring"

      SecurityGroupEgress:
        - IpProtocol: -1
          CidrIp: "172.16.0.0/12"
        - IpProtocol: -1
          CidrIp: "192.168.0.0/16"
        - IpProtocol: -1
          CidrIp: "10.0.0.0/8"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "53"
          ToPort: "53"
        - IpProtocol: "udp"
          CidrIp: "0.0.0.0/0"
          FromPort: "53"
          ToPort: "53"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "443"
          ToPort: "443"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "21"
          ToPort: "22"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "25"
          ToPort: "25"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "80"
          ToPort: "80"
        - IpProtocol: -1   #AWS Core VPC
          CidrIp: !FindInMap [ VPCaddressPrefix,values,CoreVPCSubnet ]
  VPC2RLRServersSG:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue VoiceNetwork2-Vpc
      GroupDescription: sg for RLR Servers
      Tags:
        - Key: Name
          Value: global_systems_RLR_servers_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: Cluster
          Value: Global
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
        - IpProtocol: -1   #VPN IPs
          CidrIp: 10.21.0.0/16
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "25"
          ToPort: "25"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "Rundeck Automation"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "Rundeck Automation"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "BMPCS Monitoring"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "BMPCS Monitoring"

      SecurityGroupEgress:
        - IpProtocol: -1
          CidrIp: "172.16.0.0/12"
        - IpProtocol: -1
          CidrIp: "192.168.0.0/16"
        - IpProtocol: -1
          CidrIp: "10.0.0.0/8"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "53"
          ToPort: "53"
        - IpProtocol: "udp"
          CidrIp: "0.0.0.0/0"
          FromPort: "53"
          ToPort: "53"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "443"
          ToPort: "443"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "21"
          ToPort: "22"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "25"
          ToPort: "25"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "80"
          ToPort: "80"
        - IpProtocol: -1   #AWS Core VPC
          CidrIp: !FindInMap [ VPCaddressPrefix,values,CoreVPCSubnet ]
  ACOVOCServersSG:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue VoiceNetwork-Vpc
      GroupDescription: sg for Audio Codes OVOC Servers
      Tags:
        - Key: Name
          Value: global_systems_acovoc_servers_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: Cluster
          Value: Global
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
        - IpProtocol: -1   #VPN IPs
          CidrIp: 10.21.0.0/16
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "25"     
          ToPort: "25"
        - IpProtocol: -1
          CidrIp: "10.8.36.0/23"
          Description: "LD5 Management Subnet"
        - IpProtocol: -1
          CidrIp: "10.8.52.0/23"
          Description: "MA4 Management Subnet"  
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "Rundeck Automation"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "Rundeck Automation"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "BMPCS Monitoring"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "BMPCS Monitoring"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"    

      SecurityGroupEgress:
        - IpProtocol: -1
          CidrIp: "172.16.0.0/12"
        - IpProtocol: -1
          CidrIp: "192.168.0.0/16"
        - IpProtocol: -1
          CidrIp: "10.0.0.0/8"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "53"
          ToPort: "53"
        - IpProtocol: "udp"
          CidrIp: "0.0.0.0/0"
          FromPort: "53"
          ToPort: "53"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "443"
          ToPort: "443"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "21"
          ToPort: "22"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "25"
          ToPort: "25"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "80"
          ToPort: "80"
        - IpProtocol: -1   #AWS Core VPC
          CidrIp: !FindInMap [ VPCaddressPrefix,values,CoreVPCSubnet ]
  ACOVOC2ServersSG:
      Type: 'AWS::EC2::SecurityGroup'
      Properties:
        VpcId: !ImportValue VoiceNetwork2-Vpc
        GroupDescription: sg for Audio Codes OVOC Servers
        Tags:
          - Key: Name
            Value: global_systems_acovoc2_servers_sg
          - Key: DeviceType
            Value: Network Security Group
          - Key: Cluster
            Value: Global
          - Key: InfrastructureOwner
            Value: Network Teams
          - Key: ApplicationOwner
            Value: Network Teams
          - Key: Product
            Value: SecurityGroup
        SecurityGroupIngress:
          - IpProtocol: -1   #VPN IPs
            CidrIp: 10.21.0.0/16
          - IpProtocol: "tcp"
            CidrIp: "0.0.0.0/0"
            FromPort: "25"
            ToPort: "25"
          - IpProtocol: "tcp"
            CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
            FromPort: "5985"
            ToPort: "5986"
            Description: "Rundeck Automation"
          - IpProtocol: "udp"
            CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
            FromPort: "5985"
            ToPort: "5986"
            Description: "Rundeck Automation"
          - IpProtocol: "tcp"
            CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
            FromPort: "5985"
            ToPort: "5986"
            Description: "BMPCS Monitoring"
          - IpProtocol: "udp"
            CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
            FromPort: "5985"
            ToPort: "5986"
            Description: "BMPCS Monitoring"

        SecurityGroupEgress:
          - IpProtocol: -1
            CidrIp: "172.16.0.0/12"
          - IpProtocol: -1
            CidrIp: "192.168.0.0/16"
          - IpProtocol: -1
            CidrIp: "10.0.0.0/8"
          - IpProtocol: "tcp"
            CidrIp: "0.0.0.0/0"
            FromPort: "53"
            ToPort: "53"
          - IpProtocol: "udp"
            CidrIp: "0.0.0.0/0"
            FromPort: "53"
            ToPort: "53"
          - IpProtocol: "tcp"
            CidrIp: "0.0.0.0/0"
            FromPort: "443"
            ToPort: "443"
          - IpProtocol: "tcp"
            CidrIp: "0.0.0.0/0"
            FromPort: "21"
            ToPort: "22"
          - IpProtocol: "tcp"
            CidrIp: "0.0.0.0/0"
            FromPort: "25"
            ToPort: "25"
          - IpProtocol: "tcp"
            CidrIp: "0.0.0.0/0"
            FromPort: "80"
            ToPort: "80"
          - IpProtocol: -1   #AWS Core VPC
            CidrIp: !FindInMap [ VPCaddressPrefix,values,CoreVPCSubnet ]
  InfraToolsServersSG:
      Type: 'AWS::EC2::SecurityGroup'
      Properties:
        VpcId: !ImportValue CoreNetwork-Vpc
        GroupDescription: sg for infra tools Servers
        Tags:
          - Key: Name
            Value: global_tools_Infra_tools_servers_sg
          - Key: DeviceType
            Value: Network Security Group
          - Key: Cluster
            Value: Global
          - Key: InfrastructureOwner
            Value: Network Teams
          - Key: ApplicationOwner
            Value: Network Teams
          - Key: Product
            Value: SecurityGroup
        SecurityGroupIngress:
          - IpProtocol: -1   #VPN IPs
            CidrIp: 10.21.0.0/16
          - IpProtocol: "tcp"
            CidrIp: "0.0.0.0/0"
            FromPort: "445"
            ToPort: "445"
          - IpProtocol: -1   #DMZ Subnet
            CidrIp: !FindInMap [ VPCaddressPrefix,values,DMZVPCSubnet ]
            Description: "DMZ VPC"
          - IpProtocol: -1   #Core Subnet
            CidrIp: !FindInMap [ VPCaddressPrefix,values,CoreVPCSubnet ]
            Description: "Core VPC"
          - IpProtocol: "tcp"
            CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
            FromPort: "5985"
            ToPort: "5986"
            Description: "Rundeck Automation"
          - IpProtocol: "udp"
            CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
            FromPort: "5985"
            ToPort: "5986"
            Description: "Rundeck Automation"
          - IpProtocol: "tcp"
            CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
            FromPort: "5985"
            ToPort: "5986"
            Description: "BMPCS Monitoring"
          - IpProtocol: "udp"
            CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
            FromPort: "5985"
            ToPort: "5986"
            Description: "BMPCS Monitoring"
          - IpProtocol: "tcp"
            CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
            FromPort: "8763"
            ToPort: "8763"
            Description: "INPRO Server"
          - IpProtocol: "udp"
            CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
            FromPort: "8763"
            ToPort: "8763"
            Description: "INPRO Server"
          - IpProtocol: "tcp"
            CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
            FromPort: "8763"
            ToPort: "8763"
            Description: "INPRO Server"
          - IpProtocol: "udp"
            CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
            FromPort: "8763"
            ToPort: "8763"
            Description: "INPRO Server"
          
        SecurityGroupEgress:
          - IpProtocol: -1
            CidrIp: "172.16.0.0/12"
          - IpProtocol: -1
            CidrIp: "10.0.0.0/8"
          - IpProtocol: -1
            CidrIp: "192.168.0.0/16"
          - IpProtocol: "tcp"
            CidrIp: "0.0.0.0/0"
            FromPort: "53"
            ToPort: "53"
          - IpProtocol: "udp"
            CidrIp: "0.0.0.0/0"
            FromPort: "53"
            ToPort: "53"
          - IpProtocol: "tcp"
            CidrIp: "0.0.0.0/0"
            FromPort: "443"
            ToPort: "443"
          - IpProtocol: "tcp"
            CidrIp: "0.0.0.0/0"
            FromPort: "80"
            ToPort: "80"
          - IpProtocol: "tcp"  #Amazon SES Access
            CidrIp: "0.0.0.0/0"
            FromPort: "587"
            ToPort: "587"
  DomainControllerSGChefRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref DomainControllerSG
      IpProtocol: "tcp"   #Chef
      SourceSecurityGroupId: !Ref ChefServersSG
      FromPort: "443"
      ToPort: "443"
  DomainControllerSGJumpRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref DomainControllerSG
      IpProtocol: -1   #Jump Servers
      SourceSecurityGroupId: !Ref JumpServersSG
  DomainControllerSGInfratoolsRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref DomainControllerSG
      IpProtocol: -1   #Infratools Servers
      SourceSecurityGroupId: !Ref InfraToolsServersSG
  DomainControllerSGSophosRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref DomainControllerSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref SophosServersSG
      FromPort: "8194"
      ToPort: "8194"
  DomainControllerSGBMINTRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref DomainControllerSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMINTServersSG
      FromPort: "3181"
      ToPort: "3181"
  DomainControllerSGBMPCSRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref DomainControllerSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "2059"
      ToPort: "2059"
  DomainControllerSGBMPCS2Rule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref DomainControllerSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "135"
      ToPort: "135"
  DomainControllerSGBMPC32Rule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref DomainControllerSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "445"
      ToPort: "445"
  DomainControllerSGDomainControllersRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref DomainControllerSG
      IpProtocol: -1   #Domain Controllers
      SourceSecurityGroupId: !Ref DomainControllerSG
  IntDNSServersSGDomaincontrollerRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref IntDNSServersSG
      IpProtocol: -1   #Domain Controllers All In
      SourceSecurityGroupId: !Ref DomainControllerSG
  DomainControllerSGBMCMonRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref DomainControllerSG
      IpProtocol: -1   #BMC Monitoring
      SourceSecurityGroupId: !Ref BMCMonitoringServerSG
  DomainControllerSGSnowdiscRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref DomainControllerSG
      IpProtocol: -1   #SNOW Discovery
      SourceSecurityGroupId: !Ref SnowdiscSG
  DomainControllerSGRundeckRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref DomainControllerSG
      IpProtocol: 'tcp' #Rundeck Automation 5985-5986
      SourceSecurityGroupId: !Ref RundeckServerSG
      FromPort: "5985"
      ToPort: "5986"
  DomainControllerSGPrometheusRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref DomainControllerSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref PrometheusServersSG
  
  IntDNSServersSGCheffRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref IntDNSServersSG
      IpProtocol: -1   #DNS Servers Self All In
      SourceSecurityGroupId: !Ref IntDNSServersSG
  IntDNSServersSGJumpRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref IntDNSServersSG
      IpProtocol: -1   #Jump Servers All In
      SourceSecurityGroupId: !Ref JumpServersSG
  IntDNSServersSGInfratoolsRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref IntDNSServersSG
      IpProtocol: -1   #Infratools Server All In
      SourceSecurityGroupId: !Ref InfraToolsServersSG
  IntDNSSGSophosRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref IntDNSServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref SophosServersSG
      FromPort: "8194"
      ToPort: "8194"
  IntDNSSGBMINTRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref IntDNSServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMINTServersSG
      FromPort: "3181"
      ToPort: "3181"
  IntDNSSGBMPCSRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref IntDNSServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "2059"
      ToPort: "2059"
  IntDNSSGBMPCS2Rule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref IntDNSServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "135"
      ToPort: "135"
  IntDNSSGBMPCS3Rule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref IntDNSServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "445"
      ToPort: "445"
  IntDNSSGF5CoreRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref IntDNSServersSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref NoConnTrackF5
  IntDNSServersSGRundeckRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref IntDNSServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref RundeckServerSG
      FromPort: "5985"
      ToPort: "5986"
      Description: "Rundeck Automation 5985-5986"
  IntDNSServersSGPrometheusRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref IntDNSServersSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref PrometheusServersSG

  ChefServersSGDomaincontrollerRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref ChefServersSG
      IpProtocol: -1   #Domain Controllers All In
      SourceSecurityGroupId: !Ref DomainControllerSG
  ChefServersSGCheffRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref ChefServersSG
      IpProtocol: -1   #Chef Servers All In
      SourceSecurityGroupId: !Ref ChefServersSG
  ChefServersSGJumpRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref ChefServersSG
      IpProtocol: -1   #Jump Servers All In
      SourceSecurityGroupId: !Ref JumpServersSG
  ChefServersSGInfratoolsRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref ChefServersSG
      IpProtocol: -1   #Infratools Servers All In
      SourceSecurityGroupId: !Ref InfraToolsServersSG
  ChefServersSGRundeckRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref ChefServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref RundeckServerSG
      FromPort: "5985"
      ToPort: "5986"
      Description: "Rundeck Automation 5985-5986"
  ChefServersSGPrometheusRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref ChefServersSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref PrometheusServersSG

  JumpServersSGDomainControllerRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref JumpServersSG
      IpProtocol: -1   #Domain Controllers All In
      SourceSecurityGroupId: !Ref DomainControllerSG
  JumpServersSGInfratoolsRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref JumpServersSG
      IpProtocol: -1   #Infratools Server All In
      SourceSecurityGroupId: !Ref InfraToolsServersSG
  JumpServersSGChefRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref JumpServersSG
      IpProtocol: "tcp"   #Chef All In
      SourceSecurityGroupId: !Ref ChefServersSG
      FromPort: "443"
      ToPort: "443"
  JumpServersSGJumpRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref JumpServersSG
      IpProtocol: -1   #Jump All In
      SourceSecurityGroupId: !Ref JumpServersSG
  JumpServersSGSophosRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref JumpServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref SophosServersSG
      FromPort: "8194"
      ToPort: "8194"
  JumpServersSGBMINTRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref JumpServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMINTServersSG
      FromPort: "3181"
      ToPort: "3181"
  JumpServersSGBMPCSRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref JumpServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "2059"
      ToPort: "2059"
  JumpServersSGBMPCS2Rule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref JumpServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "135"
      ToPort: "135"
  JumpServersSGBMPCS3Rule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref JumpServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "445"
      ToPort: "445"
  JumpServersSGRundeckRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref JumpServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref RundeckServerSG
      FromPort: "5985"
      ToPort: "5986"
      Description: "Rundeck Automation 5985-5986"
  JumpServersSGPrometheusRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref JumpServersSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref PrometheusServersSG

  BidServersSGBidRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref BidServersSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref BidServersSG
  BidServersSGDomainControllerRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref BidServersSG
      IpProtocol: -1   #Domain Controllers All In
      SourceSecurityGroupId: !Ref DomainControllerSG
  BidServersSGDomainInfratoolsRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref BidServersSG
      IpProtocol: -1   #Infratools All In
      SourceSecurityGroupId: !Ref InfraToolsServersSG
  BidServerSGJumpRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref BidServersSG
      IpProtocol: -1   #Jump All In
      SourceSecurityGroupId: !Ref JumpServersSG
  BidServerSGWebadminsrule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref BidServersSG
      IpProtocol: -1   #Webamins All In
      SourceSecurityGroupId: !Ref InternalGlobalWebServersSG
  BidServerSGChefRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref BidServersSG
      IpProtocol: "tcp"   #Chef All In
      SourceSecurityGroupId: !Ref ChefServersSG
      FromPort: "443"
      ToPort: "443"
  BidServerSGSophosRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref BidServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref SophosServersSG
      FromPort: "8194"
      ToPort: "8194"
  BidServerSGBMINTRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref BidServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMINTServersSG
      FromPort: "3181"
      ToPort: "3181"
  BidServerSGBMPCSRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref BidServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "2059"
      ToPort: "2059"
  BidServerSGBMPCS2Rule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref BidServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "135"
      ToPort: "135"
  BidServerSGBMPCS3Rule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref BidServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "445"
      ToPort: "445"
  BidServerSGRundeckRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref BidServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref RundeckServerSG
      FromPort: "5985"
      ToPort: "5986"
      Description: "Rundeck Automation 5985-5986"
  BidServerSGPrometheusRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref BidServersSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref PrometheusServersSG

  ASRServersSGASRRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref ASRServersSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref ASRServersSG
  ASRServersSGDomainControllerRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref ASRServersSG
      IpProtocol: -1   #Domain Controllers All In
      SourceSecurityGroupId: !Ref DomainControllerSG
  ASRServerSGJumpRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref ASRServersSG
      IpProtocol: -1   #Jump All In
      SourceSecurityGroupId: !Ref JumpServersSG
  ASRServerSGInfratoolsRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref ASRServersSG
      IpProtocol: -1   #Infratools All In
      SourceSecurityGroupId: !Ref InfraToolsServersSG
  ASRServerSGChefRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref ASRServersSG
      IpProtocol: "tcp"   #Chef All In
      SourceSecurityGroupId: !Ref ChefServersSG
      FromPort: "443"
      ToPort: "443"
  ASRServerSGSophosRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref ASRServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref SophosServersSG
      FromPort: "8194"
      ToPort: "8194"
  ASRServerSGBMINTRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref ASRServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMINTServersSG
      FromPort: "3181"
      ToPort: "3181"
  ASRServerSGBMPCSRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref ASRServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "2059"
      ToPort: "2059"
  ASRServerSGBMPCS2Rule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref ASRServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "135"
      ToPort: "135"
  ASRServerSGBMPCS3Rule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref ASRServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "445"
      ToPort: "445"
  ASRServerSGRundeckRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref ASRServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref RundeckServerSG
      FromPort: "5985"
      ToPort: "5986"
      Description: "Rundeck Automation 5985-5986"
  ASRServerSGPrometheusRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref ASRServersSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref PrometheusServersSG

  ASR2ServersSGASR2Rule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref VPC2ASRServersSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref VPC2ASRServersSG
  ASR2ServersSGASRRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref VPC2ASRServersSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref ASRServersSG
  ASRServersSGASR2Rule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref ASRServersSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref VPC2ASRServersSG
  ASR2ServersSGDomainControllerRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref VPC2ASRServersSG
      IpProtocol: -1   #Domain Controllers All In
      SourceSecurityGroupId: !Ref DomainControllerSG
  ASR2ServerSGJumpRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref VPC2ASRServersSG
      IpProtocol: -1   #Jump All In
      SourceSecurityGroupId: !Ref JumpServersSG
  ASR2ServerSGInfratoolsRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref VPC2ASRServersSG
      IpProtocol: -1   #Infratools All In
      SourceSecurityGroupId: !Ref InfraToolsServersSG
  ASR2ServerSGChefRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref VPC2ASRServersSG
      IpProtocol: "tcp"   #Chef All In
      SourceSecurityGroupId: !Ref ChefServersSG
      FromPort: "443"
      ToPort: "443"
  ASR2ServerSGSophosRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref VPC2ASRServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref SophosServersSG
      FromPort: "8194"
      ToPort: "8194"
  ASR2ServerSGBMINTRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref VPC2ASRServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMINTServersSG
      FromPort: "3181"
      ToPort: "3181"
  ASR2ServerSGBMPCSRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref VPC2ASRServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "2059"
      ToPort: "2059"
  ASR2ServerSGBMPCS2Rule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref VPC2ASRServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "135"
      ToPort: "135"
  ASR2ServerSGBMPCS3Rule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref VPC2ASRServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "445"
      ToPort: "445"
  ASR2ServerSGRundeckRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref VPC2ASRServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref RundeckServerSG
      FromPort: "5985"
      ToPort: "5986"
      Description: "Rundeck Automation 5985-5986"
  ASR2ServerSGPrometheusRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref VPC2ASRServersSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref PrometheusServersSG


  TTSServersSGTTSRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref TTSServersSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref TTSServersSG
  TTSServersSGDomainControllerRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref TTSServersSG
      IpProtocol: -1   #Domain Controllers All In
      SourceSecurityGroupId: !Ref DomainControllerSG
  TTSServerSGJumpRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref TTSServersSG
      IpProtocol: -1   #Jump All In
      SourceSecurityGroupId: !Ref JumpServersSG
  TTSServerSGInfratoolsRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref TTSServersSG
      IpProtocol: -1   #Infratools All In
      SourceSecurityGroupId: !Ref InfraToolsServersSG
  TTSServerSGChefRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref TTSServersSG
      IpProtocol: "tcp"   #Chef All In
      SourceSecurityGroupId: !Ref ChefServersSG
      FromPort: "443"
      ToPort: "443"
  TTSServersSGSophosRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref TTSServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref SophosServersSG
      FromPort: "8194"
      ToPort: "8194"
  TTSServersSGBMINTRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref TTSServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMINTServersSG
      FromPort: "3181"
      ToPort: "3181"
  TTSServersSGBMPCSRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref TTSServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "2059"
      ToPort: "2059"
  TTSServersSGBMPCS2Rule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref TTSServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "135"
      ToPort: "135"
  TTSServersSGBMPCS3Rule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref TTSServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "445"
      ToPort: "445"
  TTSServersSGRundeckRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref TTSServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref RundeckServerSG
      FromPort: "5985"
      ToPort: "5986"
      Description: "Rundeck Automation 5985-5986"
  TTSServersSGPrometheusRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref TTSServersSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref PrometheusServersSG

  TTS2ServersSGTTSRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref VPC2TTSServersSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref TTSServersSG
  TTSServersSGTTS2Rule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref TTSServersSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref VPC2TTSServersSG
  TTSServersSGTTS2InfratoolsRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref VPC2TTSServersSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref InfraToolsServersSG

  TTS2ServersSGTTS2Rule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref VPC2TTSServersSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref VPC2TTSServersSG
  TTS2ServersSGDomainControllerRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref VPC2TTSServersSG
      IpProtocol: -1   #Domain Controllers All In
      SourceSecurityGroupId: !Ref DomainControllerSG
  TTS2ServerSGJumpRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref VPC2TTSServersSG
      IpProtocol: -1   #Jump All In
      SourceSecurityGroupId: !Ref JumpServersSG
  TTS2ServerSGChefRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref VPC2TTSServersSG
      IpProtocol: "tcp"   #Chef All In
      SourceSecurityGroupId: !Ref ChefServersSG
      FromPort: "443"
      ToPort: "443"
  TTS2ServersSGSophosRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref VPC2TTSServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref SophosServersSG
      FromPort: "8194"
      ToPort: "8194"
  TTS2ServersSGBMINTRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref VPC2TTSServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMINTServersSG
      FromPort: "3181"
      ToPort: "3181"
  TTS2ServersSGBMPCSRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref VPC2TTSServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "2059"
      ToPort: "2059"
  TTS2ServersSGBMPCS2Rule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref VPC2TTSServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "135"
      ToPort: "135"
  TTS2ServersSGBMPCS3Rule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref VPC2TTSServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "445"
      ToPort: "445"
  TTS2ServersSGRundeckRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref VPC2TTSServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref RundeckServerSG
      FromPort: "5985"
      ToPort: "5986"
      Description: "Rundeck Automation 5985-5986"
  TTS2ServersSGPrometheusRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref VPC2TTSServersSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref PrometheusServersSG

  COMServersSGCOMRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref COMServersSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref COMServersSG
  COMServersSGDomainControllerRule:
      Type: 'AWS::EC2::SecurityGroupIngress'
      Properties:
        GroupId: !Ref COMServersSG
        IpProtocol: -1   #Domain Controllers All In
        SourceSecurityGroupId: !Ref DomainControllerSG
  COMServerSGJumpRule:
      Type: 'AWS::EC2::SecurityGroupIngress'
      Properties:
        GroupId: !Ref COMServersSG
        IpProtocol: -1   #Jump All In
        SourceSecurityGroupId: !Ref JumpServersSG
  COMServerSGChefRule:
      Type: 'AWS::EC2::SecurityGroupIngress'
      Properties:
        GroupId: !Ref COMServersSG
        IpProtocol: "tcp"   #Chef All In
        SourceSecurityGroupId: !Ref ChefServersSG
        FromPort: "443"
        ToPort: "443"
  COMServerSGSophosRule:
      Type: 'AWS::EC2::SecurityGroupIngress'
      Properties:
        GroupId: !Ref COMServersSG
        IpProtocol: 'tcp'
        SourceSecurityGroupId: !Ref SophosServersSG
        FromPort: "8194"
        ToPort: "8194"
  COMServerSGBMINTRule:
      Type: 'AWS::EC2::SecurityGroupIngress'
      Properties:
        GroupId: !Ref COMServersSG
        IpProtocol: 'tcp'
        SourceSecurityGroupId: !Ref BMINTServersSG
        FromPort: "3181"
        ToPort: "3181"
  COMServerSGBMPCSRule:
      Type: 'AWS::EC2::SecurityGroupIngress'
      Properties:
        GroupId: !Ref COMServersSG
        IpProtocol: 'tcp'
        SourceSecurityGroupId: !Ref BMPCSServersSG
        FromPort: "2059"
        ToPort: "2059"
  COMServerSGBMPCS2Rule:
      Type: 'AWS::EC2::SecurityGroupIngress'
      Properties:
        GroupId: !Ref COMServersSG
        IpProtocol: 'tcp'
        SourceSecurityGroupId: !Ref BMPCSServersSG
        FromPort: "135"
        ToPort: "135"
  COMServerSGBMPCS3Rule:
      Type: 'AWS::EC2::SecurityGroupIngress'
      Properties:
        GroupId: !Ref COMServersSG
        IpProtocol: 'tcp'
        SourceSecurityGroupId: !Ref BMPCSServersSG
        FromPort: "445"
        ToPort: "445"
  COMServerSGPrometheusRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref COMServersSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref PrometheusServersSG

  COM2ServersSGCOM2Rule:
      Type: 'AWS::EC2::SecurityGroupIngress'
      Properties:
        GroupId: !Ref VPC2COMServersSG
        IpProtocol: -1
        SourceSecurityGroupId: !Ref VPC2COMServersSG

  COM2ServersSGCOMRule:
      Type: 'AWS::EC2::SecurityGroupIngress'
      Properties:
        GroupId: !Ref VPC2COMServersSG
        IpProtocol: -1
        SourceSecurityGroupId: !Ref COMServersSG
  COMServersSGCOM2Rule:
      Type: 'AWS::EC2::SecurityGroupIngress'
      Properties:
        GroupId: !Ref COMServersSG
        IpProtocol: -1
        SourceSecurityGroupId: !Ref VPC2COMServersSG

  COM2ServersSGDomainControllerRule:
      Type: 'AWS::EC2::SecurityGroupIngress'
      Properties:
        GroupId: !Ref VPC2COMServersSG
        IpProtocol: -1   #Domain Controllers All In
        SourceSecurityGroupId: !Ref DomainControllerSG
  COM2ServerSGJumpRule:
      Type: 'AWS::EC2::SecurityGroupIngress'
      Properties:
        GroupId: !Ref VPC2COMServersSG
        IpProtocol: -1   #Jump All In
        SourceSecurityGroupId: !Ref JumpServersSG
  COM2ServerSGChefRule:
      Type: 'AWS::EC2::SecurityGroupIngress'
      Properties:
        GroupId: !Ref VPC2COMServersSG
        IpProtocol: "tcp"   #Chef All In
        SourceSecurityGroupId: !Ref ChefServersSG
        FromPort: "443"
        ToPort: "443"
  COM2ServerSGSophosRule:
      Type: 'AWS::EC2::SecurityGroupIngress'
      Properties:
        GroupId: !Ref VPC2COMServersSG
        IpProtocol: 'tcp'
        SourceSecurityGroupId: !Ref SophosServersSG
        FromPort: "8194"
        ToPort: "8194"
  COM2ServerSGBMINTRule:
      Type: 'AWS::EC2::SecurityGroupIngress'
      Properties:
        GroupId: !Ref VPC2COMServersSG
        IpProtocol: 'tcp'
        SourceSecurityGroupId: !Ref BMINTServersSG
        FromPort: "3181"
        ToPort: "3181"
  COM2ServerSGBMPCSRule:
      Type: 'AWS::EC2::SecurityGroupIngress'
      Properties:
        GroupId: !Ref VPC2COMServersSG
        IpProtocol: 'tcp'
        SourceSecurityGroupId: !Ref BMPCSServersSG
        FromPort: "2059"
        ToPort: "2059"
  COM2ServerSGBMPCS2Rule:
      Type: 'AWS::EC2::SecurityGroupIngress'
      Properties:
        GroupId: !Ref VPC2COMServersSG
        IpProtocol: 'tcp'
        SourceSecurityGroupId: !Ref BMPCSServersSG
        FromPort: "135"
        ToPort: "135"
  COM2ServerSGBMPCS3Rule:
      Type: 'AWS::EC2::SecurityGroupIngress'
      Properties:
        GroupId: !Ref VPC2COMServersSG
        IpProtocol: 'tcp'
        SourceSecurityGroupId: !Ref BMPCSServersSG
        FromPort: "445"
        ToPort: "445"
  COMS2erverSGPrometheusRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref VPC2COMServersSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref PrometheusServersSG

  FTPINTServerSGFTPRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref FTPINTServersSG
      IpProtocol: -1  #ftp self rule
      SourceSecurityGroupId: !Ref FTPINTServersSG
  FTPINTServersSGDomainControllerRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref FTPINTServersSG
      IpProtocol: -1   #Domain Controllers All In
      SourceSecurityGroupId: !Ref DomainControllerSG
  FTPINTServerSGJumpRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref FTPINTServersSG
      IpProtocol: -1   #Jump All In
      SourceSecurityGroupId: !Ref JumpServersSG
  FTPINTServerSGInfratoolsRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref FTPINTServersSG
      IpProtocol: -1   #Infratools All In
      SourceSecurityGroupId: !Ref InfraToolsServersSG
  FTPINTServerSGChefRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref FTPINTServersSG
      IpProtocol: "tcp"   #Chef All In
      SourceSecurityGroupId: !Ref ChefServersSG
      FromPort: "443"
      ToPort: "443"
  FTPINTServersSGSophosRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref FTPINTServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref SophosServersSG
      FromPort: "8194"
      ToPort: "8194"
  FTPINTServersSGBMINTRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref FTPINTServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMINTServersSG
      FromPort: "3181"
      ToPort: "3181"
  FTPINTServersSGBMPCSRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref FTPINTServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "2059"
      ToPort: "2059"
  FTPINTServersSGBMPCS2Rule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref FTPINTServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "135"
      ToPort: "135"
  FTPINTServersSGBMPCS3Rule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref FTPINTServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "445"
      ToPort: "445"
  FTPINTServersSGPrometheusRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref FTPINTServersSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref PrometheusServersSG

  SophosServersSGDomaincontrollerRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref SophosServersSG
      IpProtocol: -1   #Domain Controllers All In
      SourceSecurityGroupId: !Ref DomainControllerSG
  SophosServersSGCheffRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref SophosServersSG
      IpProtocol: -1   #DNS Servers Self All In
      SourceSecurityGroupId: !Ref IntDNSServersSG
  SophosServersSGJumpRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref SophosServersSG
      IpProtocol: -1   #Jump Servers All In
      SourceSecurityGroupId: !Ref JumpServersSG
  SophosServersSGInfratoolsRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref SophosServersSG
      IpProtocol: -1   #Infratools Servers All In
      SourceSecurityGroupId: !Ref InfraToolsServersSG
  SophosSGSophosRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref SophosServersSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref SophosServersSG
  SophosDirectorSGBMINTRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref SophosServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMINTServersSG
      FromPort: "3181"
      ToPort: "3181"
  SophosDirectorSGBMPCSRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref SophosServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "2059"
      ToPort: "2059"
  SophosDirectorSGBMPCS2Rule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref SophosServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "135"
      ToPort: "135"
  SophosDirectorSGBMPCS3Rule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref SophosServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "445"
      ToPort: "445"
  SophosDirectorSGPrometheusRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref SophosServersSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref PrometheusServersSG

  BMINTServersSGDomaincontrollerRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref BMINTServersSG
      IpProtocol: -1   #Domain Controllers All In
      SourceSecurityGroupId: !Ref DomainControllerSG
  BMINTServersSGCheffRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref BMINTServersSG
      IpProtocol: -1   #DNS Servers Self All In
      SourceSecurityGroupId: !Ref IntDNSServersSG
  BMINTServersSGJumpRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref BMINTServersSG
      IpProtocol: -1   #Jump Servers All In
      SourceSecurityGroupId: !Ref JumpServersSG
  BMINTSGSelfRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref BMINTServersSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref BMINTServersSG
  BMINTServersSGSophosRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref BMINTServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref SophosServersSG
      FromPort: "8194"
      ToPort: "8194"
  BMINTServersSGBMPCSRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref BMINTServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "2059"
      ToPort: "2059"
  BMINTServersSGBMPCS2Rule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref BMINTServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "135"
      ToPort: "135"
  BMINTServersSGBMPCS3Rule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref BMINTServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "445"
      ToPort: "445"
  BMINTServersSGRundeckRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref BMINTServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref RundeckServerSG
      FromPort: "5985"
      ToPort: "5986"
      Description: "Rundeck Automation 5985-5986"
  BMINTServersSGPrometheusRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref BMINTServersSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref PrometheusServersSG

  BMCMonitoringServerSGDomaincontrollerRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref BMCMonitoringServerSG
      IpProtocol: -1   #Domain Controllers All In
      SourceSecurityGroupId: !Ref DomainControllerSG

  BMCMonitoringServerSGJumpRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref BMCMonitoringServerSG
      IpProtocol: -1   #Jump Servers All In
      SourceSecurityGroupId: !Ref JumpServersSG
  BMPCSServersSGDomaincontrollerRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref BMPCSServersSG
      IpProtocol: -1   #Domain Controllers All In
      SourceSecurityGroupId: !Ref DomainControllerSG
  BMPCSServersSGCheffRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref BMPCSServersSG
      IpProtocol: -1   #DNS Servers Self All In
      SourceSecurityGroupId: !Ref IntDNSServersSG
  BMPCSServersSGJumpRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref BMPCSServersSG
      IpProtocol: -1   #Jump Servers All In
      SourceSecurityGroupId: !Ref JumpServersSG
  BMPCSSGSelfRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref BMPCSServersSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref BMINTServersSG
  BMPCSServersSGSophosRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref BMPCSServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref SophosServersSG
      FromPort: "8194"
      ToPort: "8194"
  BMPCSServersSGBMPCSRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref BMPCSServersSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref BMPCSServersSG
  BMPCSServersSGInfratoolsRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref BMPCSServersSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref InfraToolsServersSG
  BMPCSServersSGRundeckRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref BMPCSServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref RundeckServerSG
      FromPort: "5985"
      ToPort: "5986"
      Description: "Rundeck Automation 5985-5986"
  BMPCSServersSGPrometheusRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref BMPCSServersSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref PrometheusServersSG

  MailDirectorServersSGDomaincontrollerRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref MailDirectorServersSG
      IpProtocol: -1   #Domain Controllers All In
      SourceSecurityGroupId: !Ref DomainControllerSG
  MailDirectorServersSGJumpRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref MailDirectorServersSG
      IpProtocol: -1   #Jump Servers All In
      SourceSecurityGroupId: !Ref JumpServersSG
  MailDirectorSGSophosRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref MailDirectorServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref SophosServersSG
      FromPort: "8194"
      ToPort: "8194"
  MailDirectorSGBMINTRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref MailDirectorServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMINTServersSG
      FromPort: "3181"
      ToPort: "3181"
  MailDirectorSGBMPCSRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref MailDirectorServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "2059"
      ToPort: "2059"
  MailDirectorSGBMPCS2Rule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref MailDirectorServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "135"
      ToPort: "135"
  MailDirectorSGBMPCS3Rule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref MailDirectorServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "445"
      ToPort: "445"
  MailDirectorServersSGSelfRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref MailDirectorServersSG
      IpProtocol: -1   #Self Rule
      SourceSecurityGroupId: !Ref MailDirectorServersSG
  MailDirectorServersSGPrometheusRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref MailDirectorServersSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref PrometheusServersSG

  WSUSSGDomaincontrollerRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref WSUSServersSG
      IpProtocol: -1   #Domain Controllers All In
      SourceSecurityGroupId: !Ref DomainControllerSG
  WSUSServersSGJumpRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref WSUSServersSG
      IpProtocol: -1   #Jump Servers All In
      SourceSecurityGroupId: !Ref JumpServersSG
  WSUSServersSGInfratoolsRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref WSUSServersSG
      IpProtocol: -1   #Infratools Servers All In
      SourceSecurityGroupId: !Ref InfraToolsServersSG
  WSUSSGSophosRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref WSUSServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref SophosServersSG
      FromPort: "8194"
      ToPort: "8194"
  WSUSSGBMINTRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref WSUSServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMINTServersSG
      FromPort: "3181"
      ToPort: "3181"
  WSUSSGBMPCSRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref WSUSServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "2059"
      ToPort: "2059"
  WSUSSGBMPCS2Rule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref WSUSServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "135"
      ToPort: "135"
  WSUSSGBMPCS3Rule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref WSUSServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "445"
      ToPort: "445"
  WSUSServersSGSelfRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref WSUSServersSG
      IpProtocol: -1   #Self Rule
      SourceSecurityGroupId: !Ref WSUSServersSG
  WSUSServersSGRundeckRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref WSUSServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref RundeckServerSG
      FromPort: "5985"
      ToPort: "5986"
      Description: "Rundeck Automation 5985-5986"
  WSUSServersSGPrometheusRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref WSUSServersSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref PrometheusServersSG

  DBMonSGDomaincontrollerRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref DBMonServersSG
      IpProtocol: -1   #Domain Controllers All In
      SourceSecurityGroupId: !Ref DomainControllerSG
  DBMonServersSGJumpRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref DBMonServersSG
      IpProtocol: -1   #Jump Servers All In
      SourceSecurityGroupId: !Ref JumpServersSG
  DBMonServersSGInfratoolsRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref DBMonServersSG
      IpProtocol: -1   #Infratools Servers All In
      SourceSecurityGroupId: !Ref InfraToolsServersSG
  DBMonSGSophosRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref DBMonServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref SophosServersSG
      FromPort: "8194"
      ToPort: "8194"
  DBMonSGBMINTRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref DBMonServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMINTServersSG
      FromPort: "3181"
      ToPort: "3181"
  DBMonSGBMPCSRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref DBMonServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "2059"
      ToPort: "2059"
  DBMonSGBMPCS2Rule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref DBMonServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "135"
      ToPort: "135"
  DBMonSGBMPCS3Rule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref DBMonServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "445"
      ToPort: "445"
  DBMonServersSGRundeckRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref DBMonServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref RundeckServerSG
      FromPort: "5985"
      ToPort: "5986"
      Description: "Rundeck Automation 5985-5986"
  DBMonServersSGSelfRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref DBMonServersSG
      IpProtocol: -1   #Self Rule
      SourceSecurityGroupId: !Ref DBMonServersSG
  DBMonServersSGPrometheusRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref DBMonServersSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref PrometheusServersSG


  InlogSGDomaincontrollerRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref InlogServersSG
      IpProtocol: -1   #Domain Controllers All In
      SourceSecurityGroupId: !Ref DomainControllerSG
  InlogServersSGJumpRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref InlogServersSG
      IpProtocol: -1   #Jump Servers All In
      SourceSecurityGroupId: !Ref JumpServersSG
  InlogServersSGInfratoolsRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref InlogServersSG
      IpProtocol: -1   #Infratools All In
      SourceSecurityGroupId: !Ref InfraToolsServersSG
  InlogSGSophosRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref InlogServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref SophosServersSG
      FromPort: "8194"
      ToPort: "8194"
  InlogSGBMINTRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref InlogServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMINTServersSG
      FromPort: "3181"
      ToPort: "3181"
  InlogSGBMPCSRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref InlogServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "2059"
      ToPort: "2059"
  InlogSGBMPCS2Rule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref InlogServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "135"
      ToPort: "135"
  InlogSGBMPCS3Rule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref InlogServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "445"
      ToPort: "445"
  InlogServersSGSelfRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref InlogServersSG
      IpProtocol: -1   #Self Rule
      SourceSecurityGroupId: !Ref InlogServersSG
  InlogServersSGRundeckRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref InlogServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref RundeckServerSG
      FromPort: "5985"
      ToPort: "5986"
      Description: "Rundeck Automation 5985-5986"
  InlogServersSGPrometheusRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref InlogServersSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref PrometheusServersSG

  InCDRSGDomaincontrollerRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref InCDRServersSG
      IpProtocol: -1   #Domain Controllers All In
      SourceSecurityGroupId: !Ref DomainControllerSG
  InCDRServersSGJumpRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref InCDRServersSG
      IpProtocol: -1   #Jump Servers All In
      SourceSecurityGroupId: !Ref JumpServersSG
  InCDRServersSGInfratoolsRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref InCDRServersSG
      IpProtocol: -1   #Infratools Servers All In
      SourceSecurityGroupId: !Ref InfraToolsServersSG
  InCDRSGSophosRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref InCDRServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref SophosServersSG
      FromPort: "8194"
      ToPort: "8194"
  InCDRSGBMINTRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref InCDRServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMINTServersSG
      FromPort: "3181"
      ToPort: "3181"
  InCDRSGBMPCSRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref InCDRServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "2059"
      ToPort: "2059"
  InCDRSGBMPCS2Rule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref InCDRServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "135"
      ToPort: "135"
  InCDRSGBMPCS3Rule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref InCDRServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref BMPCSServersSG
      FromPort: "445"
      ToPort: "445"
  InCDRServersSGSelfRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref InCDRServersSG
      IpProtocol: -1   #Self Rule
      SourceSecurityGroupId: !Ref InCDRServersSG
  InCDRServersSGRundeckRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref InCDRServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref RundeckServerSG
      FromPort: "5985"
      ToPort: "5986"
      Description: "Rundeck Automation 5985-5986"
  InCDRServersSGPrometheusRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref InCDRServersSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref PrometheusServersSG

  GlobalWebServersSGSelfRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref GlobalWebServersSG
      IpProtocol: -1   #Self Rule
      SourceSecurityGroupId: !Ref GlobalWebServersSG
  GlobalWebServersSGDMZLoadBalancerRuleIn:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref GlobalWebServersSG
      IpProtocol: -1   #Internal Cluster
      SourceSecurityGroupId: !Ref ClusterALBSecurityGroup
  GlobalWebServersSGDMZLoadBalancerRuleHttp:
    Type: 'AWS::EC2::SecurityGroupEgress'
    Properties:
      GroupId: !Ref GlobalWebServersSG
      IpProtocol: "tcp"   #Internal Cluster
      DestinationSecurityGroupId: !Ref ClusterALBSecurityGroup
      FromPort: '80'
      ToPort: '80'
  GlobalWebServersSGDMZLoadBalancerRuleHttps:
    Type: 'AWS::EC2::SecurityGroupEgress'
    Properties:
      GroupId: !Ref GlobalWebServersSG
      IpProtocol: "tcp"   #Internal Cluster
      DestinationSecurityGroupId: !Ref ClusterALBSecurityGroup
      FromPort: '443'
      ToPort: '443'

  InFTPSGDMZSelfRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref InFTPSGDMZ
      IpProtocol: -1   #Internal Cluster
      SourceSecurityGroupId: !Ref InFTPSGDMZ
  InmailSGDMZSelfRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref InmailSGDMZ
      IpProtocol: -1   #Internal Cluster
      SourceSecurityGroupId: !Ref InmailSGDMZ
  RLRSGSelfRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref RLRServersSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref RLRServersSG
  RLRSG2SelfRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref VPC2RLRServersSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref VPC2RLRServersSG
  GlobalDBServersSelfRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref GlobalDBServersSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref GlobalDBServersSG
  GlobalDBServersJumpRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref GlobalDBServersSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref JumpServersSG
  InlmoServersJumpRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref InlmoServersSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref JumpServersSG
  InlmoServersInfratoolsRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref InlmoServersSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref InfraToolsServersSG
  InlmoServersSGRundeckRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref InlmoServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref RundeckServerSG
      FromPort: "5985"
      ToPort: "5986"
      Description: "Rundeck Automation 5985-5986"
  InlmoServersSGPrometheusRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref InlmoServersSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref PrometheusServersSG

  RadiusServersSGJumpRule:
      Type: 'AWS::EC2::SecurityGroupIngress'
      Properties:
        GroupId: !Ref NWRadiusSG
        IpProtocol: -1   #Jump Servers All In
        SourceSecurityGroupId: !Ref JumpServersSG
  RadiusServersSGInfratoolsRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref NWRadiusSG
      IpProtocol: -1   #Infratools Servers All In
      SourceSecurityGroupId: !Ref InfraToolsServersSG
  RadiusServersSGPrometheusRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref NWRadiusSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref PrometheusServersSG

  NWRadiusSGRundeckRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref NWRadiusSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref RundeckServerSG
      FromPort: "5985"
      ToPort: "5986"
      Description: "Rundeck Automation 5985-5986"
  OVOCSGJumpRule:
      Type: 'AWS::EC2::SecurityGroupIngress'
      Properties:
        GroupId: !Ref ACOVOCServersSG
        IpProtocol: -1   #Jump Servers All In
        SourceSecurityGroupId: !Ref JumpServersSG
  OVOCSGPrometheusRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref ACOVOCServersSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref PrometheusServersSG

  ACOVOCServersSGRundeckRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref ACOVOCServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref RundeckServerSG
      FromPort: "5985"
      ToPort: "5986"
      Description: "Rundeck Automation 5985-5986"
  OVOC2SGJumpRule:
      Type: 'AWS::EC2::SecurityGroupIngress'
      Properties:
        GroupId: !Ref ACOVOC2ServersSG
        IpProtocol: -1   #Jump Servers All In
        SourceSecurityGroupId: !Ref JumpServersSG
  InternalGlobalWebSGJumpRule:
      Type: 'AWS::EC2::SecurityGroupIngress'
      Properties:
        GroupId: !Ref InternalGlobalWebServersSG
        IpProtocol: -1   #Jump Servers All In
        SourceSecurityGroupId: !Ref JumpServersSG
  InternalCertificateServersSGJumpRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref InternalCertificateServersSG
      IpProtocol: -1   #Jump Servers All In
      SourceSecurityGroupId: !Ref JumpServersSG
  InternalCertificateServersSGInfratoolsRule:
      Type: 'AWS::EC2::SecurityGroupIngress'
      Properties:
        GroupId: !Ref InternalCertificateServersSG
        IpProtocol: -1   #Infratools Servers All In
        SourceSecurityGroupId: !Ref InfraToolsServersSG
  InternalCertificateServersSGWSUSRule:
      Type: 'AWS::EC2::SecurityGroupIngress'
      Properties:
        GroupId: !Ref InternalCertificateServersSG
        IpProtocol: -1   # WSUS Server
        SourceSecurityGroupId: !Ref WSUSServersSG
        Description: "WSUS Patching"
  InternalCertificateServersSGWRundeckRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref InternalCertificateServersSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref RundeckServerSG
      FromPort: "5985"
      ToPort: "5986"
      Description: "Rundeck Automation 5985-5986"
  InternalCertificateServersSGPrometheusRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref InternalCertificateServersSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref PrometheusServersSG

  ThousandEyesCoreSGJumpRule:
      Type: 'AWS::EC2::SecurityGroupIngress'
      Properties:
        GroupId: !Ref ThousandEyesCoreSG
        IpProtocol: -1   #Jump Servers All In
        SourceSecurityGroupId: !Ref JumpServersSG
  ThousandEyesCoreSGPrometheusRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref ThousandEyesCoreSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref PrometheusServersSG

## This section allows WSUS inbound to all the global SG's for patching
  ASRServersSGWSUSRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref ASRServersSG
      IpProtocol: -1   #WSUS All In
      SourceSecurityGroupId: !Ref WSUSServersSG
      Description: "WSUS Patching"
  TTSServersSGWSUSRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref TTSServersSG
      IpProtocol: -1   #WSUS All In
      SourceSecurityGroupId: !Ref WSUSServersSG
      Description: "WSUS Patching"
  VPC2ASRServersSGWSUSRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref VPC2ASRServersSG
      IpProtocol: -1   #WSUS All In
      SourceSecurityGroupId: !Ref WSUSServersSG
      Description: "WSUS Patching"
  VPC2TTSServersSGWSUSRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref VPC2TTSServersSG
      IpProtocol: -1   #WSUS All In
      SourceSecurityGroupId: !Ref WSUSServersSG
      Description: "WSUS Patching"
  BidServersSGWSUSRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref BidServersSG
      IpProtocol: -1   #WSUS All In
      SourceSecurityGroupId: !Ref WSUSServersSG
      Description: "WSUS Patching"
  BMCMonitoringServerSGWSUSRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref BMCMonitoringServerSG
      IpProtocol: -1   #WSUS All In
      SourceSecurityGroupId: !Ref WSUSServersSG
      Description: "WSUS Patching"
  BMPCSServersSGWSUSRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref BMPCSServersSG
      IpProtocol: -1   #WSUS All In
      SourceSecurityGroupId: !Ref WSUSServersSG
      Description: "WSUS Patching"
  DBMonServersSGWSUSRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref DBMonServersSG
      IpProtocol: -1   #WSUS All In
      SourceSecurityGroupId: !Ref WSUSServersSG
      Description: "WSUS Patching"
  DomainControllerSGWSUSRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref DomainControllerSG
      IpProtocol: -1   #WSUS All In
      SourceSecurityGroupId: !Ref WSUSServersSG
      Description: "WSUS Patching"
  GlobalDBServersSGWSUSRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref GlobalDBServersSG
      IpProtocol: -1   #WSUS All In
      SourceSecurityGroupId: !Ref WSUSServersSG
      Description: "WSUS Patching"
  InfraToolsServersSGWSUSRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref InfraToolsServersSG
      IpProtocol: -1   #WSUS All In
      SourceSecurityGroupId: !Ref WSUSServersSG
      Description: "WSUS Patching"
  InlmoServersSGWSUSRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref InlmoServersSG
      IpProtocol: -1   #WSUS All In
      SourceSecurityGroupId: !Ref WSUSServersSG
      Description: "WSUS Patching"
  InlogServersSGWSUSRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref InlogServersSG
      IpProtocol: -1   #WSUS All In
      SourceSecurityGroupId: !Ref WSUSServersSG
      Description: "WSUS Patching"
  IntDNSServersSGWSUSRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref IntDNSServersSG
      IpProtocol: -1   #WSUS All In
      SourceSecurityGroupId: !Ref WSUSServersSG
      Description: "WSUS Patching"
  InternalGlobalWebServersSGWSUSRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref InternalGlobalWebServersSG
      IpProtocol: -1   #WSUS All In
      SourceSecurityGroupId: !Ref WSUSServersSG
      Description: "WSUS Patching"
  NWRadiusSGWSUSRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref NWRadiusSG
      IpProtocol: -1   #WSUS All In
      SourceSecurityGroupId: !Ref WSUSServersSG
      Description: "WSUS Patching"
  SnowdiscSGWSUSRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref SnowdiscSG
      IpProtocol: -1   #WSUS All In
      SourceSecurityGroupId: !Ref WSUSServersSG
      Description: "WSUS Patching"
  SolarwindsServerSGWSUSRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref SolarwindsServerSG
      IpProtocol: -1   #WSUS All In
      SourceSecurityGroupId: !Ref WSUSServersSG
      Description: "WSUS Patching"
  SolarWindsNPMServerSGWSUSRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref SolarWindsNPMServerSG
      IpProtocol: -1   #WSUS All In
      SourceSecurityGroupId: !Ref WSUSServersSG
      Description: "WSUS Patching"
  SystemsOktaADAgentServerSGWSUSRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref SystemsOktaADAgentServerSG
      IpProtocol: -1   #WSUS All In
      SourceSecurityGroupId: !Ref WSUSServersSG
      Description: "WSUS Patching"
  JumpServersSGWSUSRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref JumpServersSG
      IpProtocol: -1   #WSUS All In
      SourceSecurityGroupId: !Ref WSUSServersSG
      Description: "WSUS Patching"

  InlmoServersSG:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue 'CoreNetwork-Vpc'
      GroupDescription: sg for Logic Monitor Servers
      Tags:
        - Key: Name
          Value: global_tools_Inlmo_servers_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: Cluster
          Value: Global
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
        - IpProtocol: -1   #VPN IPs
          CidrIp: 10.21.0.0/16
        - IpProtocol: "udp"
          CidrIp: "0.0.0.0/0"
          FromPort: "514"
          ToPort: "514"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "445"
          ToPort: "445"
        - IpProtocol: "udp"
          CidrIp: "0.0.0.0/0"
          FromPort: "162"
          ToPort: "162"
        - IpProtocol: -1
          CidrIp: "10.8.32.0/20"
          Description: "On Prem LD5 DC"
        - IpProtocol: -1
          CidrIp: "10.8.48.0/20"
          Description: "On Prem MA4 DC"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "Rundeck Automation"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "Rundeck Automation"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "BMPCS Monitoring"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "BMPCS Monitoring"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
      SecurityGroupEgress:
        - IpProtocol: -1
          CidrIp: "172.16.0.0/12"
        - IpProtocol: -1
          CidrIp: "10.0.0.0/8"
        - IpProtocol: -1
          CidrIp: "192.168.0.0/16"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "53"
          ToPort: "53"
        - IpProtocol: "udp"
          CidrIp: "0.0.0.0/0"
          FromPort: "53"
          ToPort: "53"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "443"
          ToPort: "443"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "80"
          ToPort: "80"

  ThousandEyesCoreSG:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue CoreNetwork-Vpc
      GroupDescription: sg for ThousandEyesCore Servers
      Tags:
        - Key: Name
          Value: global_tools_thousandeyes_core_servers_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: Cluster
          Value: Global
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
        - IpProtocol: -1   #VPN IPs]
          CidrIp: 10.21.0.0/16
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "445"
          ToPort: "445"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "Rundeck Automation"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "Rundeck Automation"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "BMPCS Monitoring"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "BMPCS Monitoring"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server" 

      SecurityGroupEgress:
        - IpProtocol: -1
          CidrIp: "172.16.0.0/12"
        - IpProtocol: -1
          CidrIp: "10.0.0.0/8"
        - IpProtocol: -1
          CidrIp: "192.168.0.0/16"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "53"
          ToPort: "53"
        - IpProtocol: "udp"
          CidrIp: "0.0.0.0/0"
          FromPort: "53"
          ToPort: "53"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "443"
          ToPort: "443"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "80"
          ToPort: "80"

  ThousandEyesCoreSGRundeckRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref ThousandEyesCoreSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref RundeckServerSG
      FromPort: "5985"
      ToPort: "5986"
      Description: "Rundeck Automation 5985-5986"

  PrometheusServersSG:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue CoreNetwork-Vpc
      GroupDescription: sg for prometheus Servers
      Tags:
        - Key: Name
          Value: global_systems_prometheus_server_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: Cluster
          Value: Global
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
      - IpProtocol: -1   #VPN IPs
        CidrIp: 10.21.0.0/16
      - IpProtocol: -1   #DMZ Subnet
        CidrIp: !FindInMap [ VPCaddressPrefix,values,DMZVPCSubnet ]
        Description: "DMZ VPC"
      - IpProtocol: -1   #Core Subnet
        CidrIp: !FindInMap [ VPCaddressPrefix,values,CoreVPCSubnet ]
        Description: "Core VPC"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"

      SecurityGroupEgress:
        - IpProtocol: -1
          CidrIp: 0.0.0.0/0

  PrometheusServersSGJumpRule:
      Type: 'AWS::EC2::SecurityGroupIngress'
      Properties:
        GroupId: !Ref PrometheusServersSG
        IpProtocol: -1   #Jump Servers All In
        SourceSecurityGroupId: !Ref JumpServersSG


  PrometheusServersSGDCRule:
      Type: 'AWS::EC2::SecurityGroupIngress'
      Properties:
        GroupId: !Ref PrometheusServersSG
        IpProtocol: -1   #Jump Servers All In
        SourceSecurityGroupId: !Ref DomainControllerSG

  PrometheusServersSGChefRule:
      Type: 'AWS::EC2::SecurityGroupIngress'
      Properties:
        GroupId: !Ref PrometheusServersSG
        IpProtocol: -1   #Jump Servers All In
        SourceSecurityGroupId: !Ref ChefServersSG



  SystemsOktaADAgentServerSG:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue CoreNetwork-Vpc
      GroupDescription: sg for SystemsOktaADAgent Server
      Tags:
        - Key: Name
          Value: global_systems_SystemsOktaADAgent_server_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: Cluster
          Value: Global
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
        - IpProtocol: -1   #VPN IPs
          CidrIp: 10.21.0.0/16
        - IpProtocol: -1   #Core Subnet
          CidrIp: !FindInMap [ VPCaddressPrefix,values,Az1CoreSubnet ]
          Description: "CoreNetworkAz1CoreSubnet"
        - IpProtocol: -1   #Core Subnet
          CidrIp: !FindInMap [ VPCaddressPrefix,values,Az2CoreSubnet ]
          Description: "CoreNetworkAz2CoreSubnet"
        - IpProtocol: "tcp"   #LDAP
          CidrIp: "0.0.0.0/0"
          FromPort: "389"
          ToPort: "389"
          Description: "LDAP"
        - IpProtocol: "udp"   #LDAP
          CidrIp: "0.0.0.0/0"
          FromPort: "389"
          ToPort: "389"
          Description: "LDAP"
        - IpProtocol: "tcp"   #LDAP SSL
          CidrIp: "0.0.0.0/0"
          FromPort: "636"
          ToPort: "636"
          Description: "LDAP SSL"
        - IpProtocol: "tcp"   #LDAP GC
          CidrIp: "0.0.0.0/0"
          FromPort: "3268"
          ToPort: "3268"
          Description: "LDAP GC"
        - IpProtocol: "tcp"   #LDAP GC SSL
          CidrIp: "0.0.0.0/0"
          FromPort: "3269"
          ToPort: "3269"
          Description: "LDAP GC SSL"
        - IpProtocol: "tcp"   #Kerberos
          CidrIp: "0.0.0.0/0"
          FromPort: "88"
          ToPort: "88"
          Description: "Kerberos"
        - IpProtocol: "udp"   #Kerberos
          CidrIp: "0.0.0.0/0"
          FromPort: "88"
          ToPort: "88"
          Description: "Kerberos"
        - IpProtocol: "tcp"   #DNS
          CidrIp: "0.0.0.0/0"
          FromPort: "53"
          ToPort: "53"
          Description: "DNS"
        - IpProtocol: "udp"   #DNS
          CidrIp: "0.0.0.0/0"
          FromPort: "53"
          ToPort: "53"
          Description: "DNS"
        - IpProtocol: "tcp"   #SMB
          CidrIp: "0.0.0.0/0"
          FromPort: "445"
          ToPort: "445"
          Description: "SMB"
        - IpProtocol: "tcp"   #RPC
          CidrIp: "0.0.0.0/0"
          FromPort: "135"
          ToPort: "135"
          Description: "RPC"
        - IpProtocol: "udp"   #Windows Time
          CidrIp: "0.0.0.0/0"
          FromPort: "123"
          ToPort: "123"
          Description: "NTP"
        - IpProtocol: "tcp"   #Kerberos Password MGMT
          CidrIp: "0.0.0.0/0"
          FromPort: "464"
          ToPort: "464"
          Description: "Kerberos PWS MGMT"
        - IpProtocol: "udp"   #Kerberos Password MGMT
          CidrIp: "0.0.0.0/0"
          FromPort: "464"
          ToPort: "464"
          Description: "Kerberos PWD MGMT"
        - IpProtocol: "tcp"   #RPC DCOM Group Policy
          CidrIp: "0.0.0.0/0"
          FromPort: "49152"
          ToPort: "65535"
          Description: "Group Policy"
        - IpProtocol: "udp"   #DFSN, NETLOGON
          CidrIp: "0.0.0.0/0"
          FromPort: "138"
          ToPort: "138"
          Description: "Netlogon"
        - IpProtocol: "udp"   #NETLOGON, NetBIOS
          CidrIp: "0.0.0.0/0"
          FromPort: "137"
          ToPort: "137"
          Description: "NetBIOS"
        - IpProtocol: "tcp"   #NetLogon
          CidrIp: "0.0.0.0/0"
          FromPort: "139"
          ToPort: "139"
          Description: "Netlogon"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "Rundeck Automation"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "Rundeck Automation"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "BMPCS Monitoring"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "BMPCS Monitoring"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
    

      SecurityGroupEgress:
        - IpProtocol: -1
          CidrIp: "172.16.0.0/12"
        - IpProtocol: -1
          CidrIp: "10.0.0.0/8"
        - IpProtocol: -1
          CidrIp: "192.168.0.0/16"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "53"
          ToPort: "53"
        - IpProtocol: "udp"
          CidrIp: "0.0.0.0/0"
          FromPort: "53"
          ToPort: "53"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "443"
          ToPort: "443"





  SystemsOktaADAgentServerSGJumpRule:
      Type: 'AWS::EC2::SecurityGroupIngress'
      Properties:
        GroupId: !Ref SystemsOktaADAgentServerSG
        IpProtocol: -1   #Jump Servers All In
        SourceSecurityGroupId: !Ref JumpServersSG


  SystemsOktaADAgentServerSGDCRule:
      Type: 'AWS::EC2::SecurityGroupIngress'
      Properties:
        GroupId: !Ref SystemsOktaADAgentServerSG
        IpProtocol: -1   #Jump Servers All In
        SourceSecurityGroupId: !Ref DomainControllerSG

  SystemsOktaADAgentServerSGChefRule:
      Type: 'AWS::EC2::SecurityGroupIngress'
      Properties:
        GroupId: !Ref SystemsOktaADAgentServerSG
        IpProtocol: -1   #Jump Servers All In
        SourceSecurityGroupId: !Ref ChefServersSG
  SystemsOktaADAgentServerSGRundeckRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref SystemsOktaADAgentServerSG
      IpProtocol: 'tcp'
      SourceSecurityGroupId: !Ref RundeckServerSG
      FromPort: "5985"
      ToPort: "5986"
      Description: "Rundeck Automation 5985-5986"
  SystemsOktaADAgentServerSGPrometheusRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref SystemsOktaADAgentServerSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref PrometheusServersSG

  RundeckServerSG:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue CoreNetwork-Vpc
      GroupDescription: sg for Rundeck Server
      Tags:
        - Key: Name
          Value: global_tools_Rundeck_server_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: Cluster
          Value: Global
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
      - IpProtocol: -1   #VPN IPs
        CidrIp: 10.21.0.0/16
      - IpProtocol: -1   #DMZ Subnet
        CidrIp: !FindInMap [ VPCaddressPrefix,values,DMZVPCSubnet ]
        Description: "DMZ VPC"
      - IpProtocol: -1   #Core Subnet
        CidrIp: !FindInMap [ VPCaddressPrefix,values,CoreVPCSubnet ]
        Description: "Core VPC"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
        FromPort: "8763"
        ToPort: "8763"
        Description: "INPRO Server"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
        FromPort: "8763"
        ToPort: "8763"
        Description: "INPRO Server"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
        FromPort: "8763"
        ToPort: "8763"
        Description: "INPRO Server"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
        FromPort: "8763"
        ToPort: "8763"
        Description: "INPRO Server"
      SecurityGroupEgress:
      - IpProtocol: -1
        CidrIp: "172.16.0.0/12"
      - IpProtocol: -1
        CidrIp: "10.0.0.0/8"
      - IpProtocol: -1
        CidrIp: "192.168.0.0/16"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
      - IpProtocol: "udp"
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "443"
        ToPort: "443"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "80"
        ToPort: "80"

  RundeckServerSGJumpRule:
      Type: 'AWS::EC2::SecurityGroupIngress'
      Properties:
        GroupId: !Ref RundeckServerSG
        IpProtocol: -1   #Jump Servers All In
        SourceSecurityGroupId: !Ref JumpServersSG


  RundeckServerSGDCRule:
      Type: 'AWS::EC2::SecurityGroupIngress'
      Properties:
        GroupId: !Ref RundeckServerSG
        IpProtocol: -1   #Jump Servers All In
        SourceSecurityGroupId: !Ref DomainControllerSG

  RundeckServerSGChefRule:
      Type: 'AWS::EC2::SecurityGroupIngress'
      Properties:
        GroupId: !Ref RundeckServerSG
        IpProtocol: -1   #Jump Servers All In
        SourceSecurityGroupId: !Ref ChefServersSG
  RundeckServerSGPrometheusRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref RundeckServerSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref PrometheusServersSG


  SolarwindsServerSG:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue CoreNetwork-Vpc
      GroupDescription: sg for Solarwinds Server
      Tags:
        - Key: Name
          Value: global_tools_Solarwinds_server_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: Cluster
          Value: Global
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
      - IpProtocol: -1   #VPN IPs
        CidrIp: 10.21.0.0/16
      - IpProtocol: -1   #DMZ Subnet
        CidrIp: !FindInMap [ VPCaddressPrefix,values,DMZVPCSubnet ]
        Description: "DMZ VPC"
      - IpProtocol: -1   #Core Subnet
        CidrIp: !FindInMap [ VPCaddressPrefix,values,CoreVPCSubnet ]
        Description: "Core VPC"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
        FromPort: "8763"
        ToPort: "8763"
        Description: "INPRO Server"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
        FromPort: "8763"
        ToPort: "8763"
        Description: "INPRO Server"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
        FromPort: "8763"
        ToPort: "8763"
        Description: "INPRO Server"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
        FromPort: "8763"
        ToPort: "8763"
        Description: "INPRO Server"
        
      SecurityGroupEgress:
      - IpProtocol: -1
        CidrIp: "172.16.0.0/12"
      - IpProtocol: -1
        CidrIp: "10.0.0.0/8"
      - IpProtocol: -1
        CidrIp: "192.168.0.0/16"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
      - IpProtocol: "udp"
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "443"
        ToPort: "443"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "80"
        ToPort: "80"

  SolarwindsServerSGJumpRule:
      Type: 'AWS::EC2::SecurityGroupIngress'
      Properties:
        GroupId: !Ref SolarwindsServerSG
        IpProtocol: -1   #Jump Servers All In
        SourceSecurityGroupId: !Ref JumpServersSG


  SolarwindsServerSGDCRule:
      Type: 'AWS::EC2::SecurityGroupIngress'
      Properties:
        GroupId: !Ref SolarwindsServerSG
        IpProtocol: -1   #Jump Servers All In
        SourceSecurityGroupId: !Ref DomainControllerSG

  SolarwindsServerSGChefRule:
      Type: 'AWS::EC2::SecurityGroupIngress'
      Properties:
        GroupId: !Ref SolarwindsServerSG
        IpProtocol: -1   #Jump Servers All In
        SourceSecurityGroupId: !Ref ChefServersSG
  SolarwindsServerSGPrometheusRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref SolarwindsServerSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref PrometheusServersSG


  SolarWindsNPMServerSG:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue CoreNetwork-Vpc
      GroupDescription: sg for SolarWindsNPM Server
      Tags:
        - Key: Name
          Value: global_tools_SolarWindsNPM_server_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: Cluster
          Value: Global
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
      - IpProtocol: -1   #VPN IPs
        CidrIp: 10.21.0.0/16
      - IpProtocol: -1   #DMZ Subnet
        CidrIp: !FindInMap [ VPCaddressPrefix,values,DMZVPCSubnet ]
        Description: "DMZ VPC"
      - IpProtocol: -1   #Core Subnet
        CidrIp: !FindInMap [ VPCaddressPrefix,values,CoreVPCSubnet ]
        Description: "Core VPC"
      - IpProtocol: "udp"
        CidrIp: "0.0.0.0/0"
        FromPort: "161"
        ToPort: "162"
        Description: "SNMP"
      - IpProtocol: -1
        CidrIp: "10.8.32.0/20"
        Description: "On Prem LD5 DC"
      - IpProtocol: -1
        CidrIp: "10.8.48.0/20"
        Description: "On Prem MA4 DC"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"
      SecurityGroupEgress:
      - IpProtocol: -1
        CidrIp: "172.16.0.0/12"
      - IpProtocol: -1
        CidrIp: "10.0.0.0/8"
      - IpProtocol: -1
        CidrIp: "192.168.0.0/16"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
      - IpProtocol: "udp"
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "443"
        ToPort: "443"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "80"
        ToPort: "80"

  SolarWindsNPMServerSGJumpRule:
      Type: 'AWS::EC2::SecurityGroupIngress'
      Properties:
        GroupId: !Ref SolarWindsNPMServerSG
        IpProtocol: -1   #Jump Servers All In
        SourceSecurityGroupId: !Ref JumpServersSG


  SolarWindsNPMServerSGDCRule:
      Type: 'AWS::EC2::SecurityGroupIngress'
      Properties:
        GroupId: !Ref SolarWindsNPMServerSG
        IpProtocol: -1   #Jump Servers All In
        SourceSecurityGroupId: !Ref DomainControllerSG

  SolarWindsNPMServerSGChefRule:
      Type: 'AWS::EC2::SecurityGroupIngress'
      Properties:
        GroupId: !Ref SolarWindsNPMServerSG
        IpProtocol: -1   #Jump Servers All In
        SourceSecurityGroupId: !Ref ChefServersSG
  SolarWindsNPMServerSGPrometheusRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref SolarWindsNPMServerSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref PrometheusServersSG


  BgFTPSGDMZ:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue DMZNetwork-Vpc
      GroupDescription: sg for BgFTP Servers
      Tags:
        - Key: Name
          Value: global_systems_bgftp_servers_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: Cluster
          Value: Global
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
        - IpProtocol: -1   #AWS Core VPC
          CidrIp: !FindInMap [ VPCaddressPrefix,values,CoreVPCSubnet ]
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,Corpdwsourceip1 ]
          FromPort: "22"
          ToPort: "22"
          Description: "corp dw source ips"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,Corpdwsourceip2 ]
          FromPort: "22"
          ToPort: "22"
          Description: "corp dw source ips"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,Corpdwsourceip3 ]
          FromPort: "22"
          ToPort: "22"
          Description: "corp dw source ips"
        - IpProtocol: "tcp"
          CidrIp: "10.232.194.178/32"
          FromPort: "44501"
          ToPort: "44501"
          Description: ukloa-incdr01
        - IpProtocol: "tcp"
          CidrIp: "10.232.198.155/32"
          FromPort: "44501"
          ToPort: "44501"
          Description: uklob-incdr01 
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "Rundeck Automation"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "Rundeck Automation"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "BMPCS Monitoring"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
          FromPort: "5985"
          ToPort: "5986"
          Description: "BMPCS Monitoring"   
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,AsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "tcp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"
        - IpProtocol: "udp"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,BsideINPRO01 ]
          FromPort: "8763"
          ToPort: "8763"
          Description: "INPRO Server"      
#        - IpProtocol: "tcp"   #NOTE: THIS IP WILL CHANGE FOR EVERY SOV REGION
#          CidrIp: !FindInMap [ VPCaddressPrefix,values,mclazurecostguardsourceip ]
#          FromPort: "22"
#          ToPort: "22"
#          Description: "mcl azure costguard source ip"

      SecurityGroupEgress:
        - IpProtocol: -1
          CidrIp: "172.16.0.0/12"
        - IpProtocol: -1
          CidrIp: "192.168.0.0/16"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "53"
          ToPort: "53"
        - IpProtocol: "udp"
          CidrIp: "0.0.0.0/0"
          FromPort: "53"
          ToPort: "53"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "443"
          ToPort: "443"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "21"
          ToPort: "22"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "80"
          ToPort: "80"
        - IpProtocol: -1   #AWS Core VPC
          CidrIp: !FindInMap [ VPCaddressPrefix,values,CoreVPCSubnet ]



  BgFTPSGDMZSelfRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref BgFTPSGDMZ
      IpProtocol: -1   #Internal Cluster
      SourceSecurityGroupId: !Ref BgFTPSGDMZ

  TechSupportToolsServerSG:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue CoreNetwork-Vpc
      GroupDescription: sg for Tech Support Tools Server
      Tags:
        - Key: Name
          Value: global_systems_TechSupportTools_servers_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: Cluster
          Value: Global
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "443"
          ToPort: "443"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "80"
          ToPort: "80"
        - IpProtocol: "tcp"   #Microsoft Remote Procedure Call
          CidrIp: "0.0.0.0/0"
          FromPort: "135"
          ToPort: "135"
          Description: "Microsoft Remote Procedure Call"
        - IpProtocol: "tcp"   #MSSQL
          CidrIp: "0.0.0.0/0"
          FromPort: "1433"
          ToPort: "1433"
          Description: "SQL"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "1443"
          ToPort: "1443"
          Description: "SQL Server-Nonstandard/custom SQL port "
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "1434"
          ToPort: "1434"
          Description: "SQL Server-SQL Browser & Dedicated Admin Connection resolver"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "2382"
          ToPort: "2382"
          Description: "SQL Server-SSAS Browser for named instances"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "2383"
          ToPort: "2383"
          Description: "SQL Server-SSAS default instance port"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "4022"
          ToPort: "4022"
          Description: "SQL Server-SQL Server Service Broker for internal messaging"
      SecurityGroupEgress:
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "443"
          ToPort: "443"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "80"
          ToPort: "80"
        - IpProtocol: "tcp"   #Microsoft Remote Procedure Call
          CidrIp: "0.0.0.0/0"
          FromPort: "135"
          ToPort: "135"
          Description: "Microsoft Remote Procedure Call"
        - IpProtocol: "tcp"   #MSSQL
          CidrIp: "0.0.0.0/0"
          FromPort: "1433"
          ToPort: "1433"
          Description: "SQL"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "1443"
          ToPort: "1443"
          Description: "SQL Server-Nonstandard/custom SQL port "
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "1434"
          ToPort: "1434"
          Description: "SQL Server-SQL Browser & Dedicated Admin Connection resolver"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "2382"
          ToPort: "2382"
          Description: "SQL Server-SSAS Browser for named instances"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "2383"
          ToPort: "2383"
          Description: "SQL Server-SSAS default instance port"
        - IpProtocol: "tcp"
          CidrIp: "0.0.0.0/0"
          FromPort: "4022"
          ToPort: "4022"
          Description: "SQL Server-SQL Server Service Broker for internal messaging"

  TechSupportToolsServerSGJumpRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref TechSupportToolsServerSG
      IpProtocol: -1   #Jump Servers All In
      Description: Jump Servers
      SourceSecurityGroupId: !Ref JumpServersSG

## Build Sonus SG when RAMP servers and Sov Data Centers are ready, update the Inbound IP list per Sov region.
  SonusNLBSecurityGroup:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue DMZNetwork-Vpc
      GroupDescription: Security group for SonusNLB
      Tags:
        - Key: Name
          Value: sonus_nlb_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: Cluster
          Value: Global
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
        - IpProtocol: "tcp"
          FromPort: "443"
          ToPort: "443"
          CidrIp: "18.169.94.253/32"   ##UK Sov Az1 Core NAT
          Description: "EU Sov Az1 Core NAT"
        - IpProtocol: "tcp"
          FromPort: "443"
          ToPort: "443"
          CidrIp: "18.130.107.140/32"   ##UK Sov Az2 Core NAT
          Description: "EU Sov Az2 Core NAT"
        - IpProtocol: "tcp"
          FromPort: "443"
          ToPort: "443"
          CidrIp: "154.46.17.24/29"   ##LD5 DC NAT
          Description: "FR8 DC NAT"
        - IpProtocol: "tcp"
          FromPort: "443"
          ToPort: "443"
          CidrIp: "149.13.186.24/29"   ##MA4 DC NAT
          Description: "MU4 DC NAT"
        - IpProtocol: "tcp"
          FromPort: "443"
          ToPort: "443"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,Corpdwsourceip1 ]  ##ViaWest Corp
          Description: "ViaWest Corp"
        - IpProtocol: "tcp"
          FromPort: "443"
          ToPort: "443"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,Corpdwsourceip2 ]  ##ViaWest Corp
          Description: "ViaWest Corp"
        - IpProtocol: "tcp"
          FromPort: "443"
          ToPort: "443"
          CidrIp: !FindInMap [ VPCaddressPrefix,values,Corpdwsourceip3 ]   ##ViaWest Corp
          Description: "ViaWest Corp"
      SecurityGroupEgress:
        - IpProtocol: -1
          CidrIp: 0.0.0.0/0





#VOICE SECURITY GROUPS

  InternalServerSecurityGroup:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      GroupDescription: Internal server security group
      VpcId: !ImportValue VoiceNetwork-Vpc
      SecurityGroupIngress:
        - IpProtocol: '-1'
          FromPort: '0'
          ToPort: '65535'
          CidrIp: 10.21.0.0/16

      SecurityGroupEgress:
        - IpProtocol: '-1'
          CidrIp: 0.0.0.0/0
      Tags:
        - Key: Name
          Value: voice_internal_sg
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup


  VoiceInCDRServersSG:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue VoiceNetwork-Vpc
      GroupDescription: sg for InCDR Servers
      Tags:
        - Key: Name
          Value: global_tools_InCDR_servers_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
      - IpProtocol: -1   #VPN IPs
        CidrIp: 10.21.0.0/16
        Description: "GP VPN"
      - IpProtocol: -1
        CidrIp: "10.8.36.0/23"
        Description: "LD5 Management"
      - IpProtocol: -1
        CidrIp: "10.8.52.0/23"
        Description: "MA4 Management"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"
#      - IpProtocol: -1   #On Prem FR8 DC
#        CidrIp: 10.8.0.0/20
#        Description: "On Prem FR8 DC"
#      - IpProtocol: -1   #On Prem MU4 DC
#        CidrIp: 10.8.16.0/20
#        Description: "On Prem MU4 DC"
#      - IpProtocol: "tcp"
#        CidrIp: "10.232.73.136/32"
#        FromPort: "5985"
#        ToPort:  "5986"
#        Description: "Rundeck Automation 5985-5986"

      SecurityGroupEgress:
      - IpProtocol: -1
        CidrIp: "172.16.0.0/12"
      - IpProtocol: -1
        CidrIp: "10.0.0.0/8"
      - IpProtocol: -1
        CidrIp: "192.168.0.0/16"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
      - IpProtocol: "udp"
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "443"
        ToPort: "443"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "80"
        ToPort: "80"
  VoiceInCDRServersSGDomaincontrollerRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref VoiceInCDRServersSG
      IpProtocol: -1   #Domain Controllers All In
      Description: Domain Controllers
      SourceSecurityGroupId: !Ref DomainControllerSG
  VoiceInCDRServersSGJumpRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref VoiceInCDRServersSG
      IpProtocol: -1   #Jump Servers All In
      Description: Jump Servers
      SourceSecurityGroupId: !Ref JumpServersSG
  VoiceInCDRServersSGInfratoolsRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref VoiceInCDRServersSG
      IpProtocol: -1   #Infratools Servers All In
      SourceSecurityGroupId: !Ref InfraToolsServersSG
      Description: InfraTools
  VoiceInCDRServersSGSSHRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref VoiceInCDRServersSG
      IpProtocol: 'tcp'
      FromPort: "22"
      ToPort: "22"
      Description: Globalscape SSH Port
      SourceSecurityGroupId: !Ref VPC2InCDRServersSG
  VoiceInCDRServersSGSMB139Rule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref VoiceInCDRServersSG
      IpProtocol: 'tcp'
      FromPort: "139"
      ToPort: "139"
      Description: Globalscape SMB Port
      SourceSecurityGroupId: !Ref VPC2InCDRServersSG
  VoiceInCDRServersSGSMB445Rule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref VoiceInCDRServersSG
      IpProtocol: 'tcp'
      FromPort: "445"
      ToPort: "445"
      Description: Globalscape SMB Port
      SourceSecurityGroupId: !Ref VPC2InCDRServersSG



  RibbonAnalyticsSG:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue VoiceNetwork-Vpc
      GroupDescription: sg for RibbonAnalytics Server
      Tags:
        - Key: Name
          Value: global_tools_RibbonAnalytics_servers_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
      - IpProtocol: -1   #VPN IPs
        CidrIp: 10.21.0.0/16
      - IpProtocol: -1
        CidrIp: !FindInMap [ VPCaddressPrefix,values, voicemgmtOctet ]
      - IpProtocol: -1
        CidrIp: !FindInMap [ VPCaddressPrefix,values, voice2mgmtOctet ]
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"

      SecurityGroupEgress:
      - IpProtocol: -1
        CidrIp: "172.16.0.0/12"
      - IpProtocol: -1
        CidrIp: "10.0.0.0/8"
      - IpProtocol: -1
        CidrIp: "192.168.0.0/16"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
      - IpProtocol: "udp"
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "443"
        ToPort: "443"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "80"
        ToPort: "80"
  RibbonAnalyticsSGDomaincontrollerRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref RibbonAnalyticsSG
      IpProtocol: -1   #Domain Controllers All In
      SourceSecurityGroupId: !Ref DomainControllerSG
  RibbonAnalyticsSGJumpRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref RibbonAnalyticsSG
      IpProtocol: -1   #Jump Servers All In
      SourceSecurityGroupId: !Ref JumpServersSG
  RibbonAnalyticsSGChefServersRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref RibbonAnalyticsSG
      IpProtocol: -1   #Infratools Servers All In
      SourceSecurityGroupId: !Ref ChefServersSG
  RibbonAnalyticsSGPrometheusRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref RibbonAnalyticsSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref PrometheusServersSG

#SG for Ribbon Device Interface
  RibbonAnalyticsDeviceSG:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue VoiceNetwork-Vpc
      GroupDescription: sg for RibbonAnalytics Server Device Interface
      Tags:
        - Key: Name
          Value: global_tools_RibbonAnalyticsDevice_servers_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
      - IpProtocol: -1   #VPN IPs
        CidrIp: 10.21.0.0/16
        Description: "VPN IPs"
      - IpProtocol: -1
        CidrIp: !FindInMap [ VPCaddressPrefix,values, voicetrustOctet ]
      - IpProtocol: -1
        CidrIp: !FindInMap [ VPCaddressPrefix,values, voice2trustOctet ]
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"

      SecurityGroupEgress:
      - IpProtocol: -1
        CidrIp: "172.16.0.0/12"
      - IpProtocol: -1
        CidrIp: "10.0.0.0/8"
      - IpProtocol: -1
        CidrIp: "192.168.0.0/16"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
      - IpProtocol: "udp"
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "443"
        ToPort: "443"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "80"
        ToPort: "80"

  RibbonAnalyticsDeviceSGDomaincontrollerRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref RibbonAnalyticsDeviceSG
      IpProtocol: -1   #Domain Controllers All In
      SourceSecurityGroupId: !Ref DomainControllerSG
  RibbonAnalyticsDeviceSGJumpRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref RibbonAnalyticsDeviceSG
      IpProtocol: -1   #Jump Servers All In
      SourceSecurityGroupId: !Ref JumpServersSG
  RibbonAnalyticsDeviceSGChefServersRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref RibbonAnalyticsDeviceSG
      IpProtocol: -1   #Infratools Servers All In
      SourceSecurityGroupId: !Ref ChefServersSG
  RibbonAnalyticsDeviceSGPrometheusRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref RibbonAnalyticsDeviceSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref PrometheusServersSG


#SG for Ribbon PSX
  VoiceRibbonPsxSecurityGroup:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue VoiceNetwork-Vpc
      GroupDescription: Ribbon PSX security group
      Tags:
        - Key: Name
          Value:
            'Fn::Join':
              - '-'
              - - Ref: SystemName
                - psxSG
        - Key: ApplicationOwner
          Value: Voice Teams
        - Key: InfrastructureOwner
          Value: Voice Teams
        - Key: Cluster
          Value: Global
        - Key: Product
          Value: Infrastructure
        - Key: Service
          Value: AWS Voice POP
        - Key: DeviceType
          Value: Ribbon PSX
        - Key: Owner
          Value: Network Teams
        - Key: Product
          Value: Infrastructure
      SecurityGroupIngress:
        - Description: SSReq Traffic
          IpProtocol: tcp
          FromPort: '3091'
          ToPort: '3091'
          CidrIp: 0.0.0.0/0
        - Description: UDP Traffic
          IpProtocol: udp
          FromPort: '3053'
          ToPort: '3055'
          CidrIp: 0.0.0.0/0
        - Description: PES Traffic
          IpProtocol: udp
          FromPort: '9004'
          ToPort: '9004'
          CidrIp: 0.0.0.0/0
        - Description: DNS UDP
          IpProtocol: udp
          FromPort: '53'
          ToPort: '53'
          CidrIp: 0.0.0.0/0
        - Description: NTP
          IpProtocol: udp
          FromPort: '123'
          ToPort: '123'
          CidrIp: 0.0.0.0/0
        - Description: DBREPD Data
          IpProtocol: tcp
          FromPort: '3080'
          ToPort: '3080'
          CidrIp: 0.0.0.0/0
        - Description: ICMP Ping
          IpProtocol: icmp
          FromPort: '-1'
          ToPort: '-1'
          CidrIp: 0.0.0.0/0
        - Description: SIPE TCP Traffic
          IpProtocol: tcp
          FromPort: '5060'
          ToPort: '5060'
          CidrIp: 0.0.0.0/0
        - Description: JAVA
          IpProtocol: udp
          FromPort: '161'
          ToPort: '161'
          CidrIp: 0.0.0.0/0
        - Description: DBREPD Control
          IpProtocol: tcp
          FromPort: '3090'
          ToPort: '3090'
          CidrIp: 0.0.0.0/0
        - Description: SSH to CLI
          IpProtocol: tcp
          FromPort: '22'
          ToPort: '22'
          CidrIp: 0.0.0.0/0
        - Description: Sonus Agent
          IpProtocol: tcp
          FromPort: '19991'
          ToPort: '19991'
          CidrIp: 0.0.0.0/0
        - Description: SIPE UDP Traffic
          IpProtocol: udp
          FromPort: '5060'
          ToPort: '5060'
          CidrIp: 0.0.0.0/0
        - Description: SFTP Traffic
          IpProtocol: tcp
          FromPort: '6462'
          ToPort: '6462'
          CidrIp: 0.0.0.0/0
        - Description: Service Director
          IpProtocol: tcp
          FromPort: '5000'
          ToPort: '5000'
          CidrIp: 0.0.0.0/0
        - Description: PostgreSQL listener
          IpProtocol: tcp
          FromPort: '5432'
          ToPort: '5432'
          CidrIp: 0.0.0.0/0
        - Description: Pgbouncer
          IpProtocol: tcp
          FromPort: '6432'
          ToPort: '6432'
          CidrIp: 0.0.0.0/0
        - Description: RAMP registration
          IpProtocol: tcp
          FromPort: '443'
          ToPort: '443'
          CidrIp: 0.0.0.0/0
        - Description: DNS/ENUM TCP
          IpProtocol: tcp
          FromPort: '53'
          ToPort: '53'
          CidrIp: 0.0.0.0/0
      SecurityGroupEgress:
        - IpProtocol: -1
          CidrIp: 0.0.0.0/0


  VoiceRibbonPsxSGJumpRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref VoiceRibbonPsxSecurityGroup
      IpProtocol: -1   #Jump Servers All In
      SourceSecurityGroupId: !Ref JumpServersSG


#VOICE VPC 2 SECURITY GROUPS

  VPC2InternalServerSecurityGroup:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      GroupDescription: Internal server security group for Voice VPC2
      VpcId: !ImportValue VoiceNetwork2-Vpc
      SecurityGroupIngress:
        - IpProtocol: '-1'
          FromPort: '0'
          ToPort: '65535'
          CidrIp: 10.21.0.0/16

      SecurityGroupEgress:
        - IpProtocol: '-1'
          CidrIp: 0.0.0.0/0
      Tags:
        - Key: Name
          Value: voice_vpc2_internal_sg
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup


  VPC2InCDRServersSG:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue VoiceNetwork2-Vpc
      GroupDescription: sg for InCDR Servers
      Tags:
        - Key: Name
          Value: global_tools_vpc2_InCDR_servers_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
      - IpProtocol: -1   #VPN IPs
        CidrIp: 10.21.0.0/16
        Description: "GP VPN"
      - IpProtocol: -1
        CidrIp: "10.8.36.0/23"
        Description: "LD5 Management"
      - IpProtocol: -1
        CidrIp: "10.8.52.0/23"
        Description: "MA4 Management"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"
#      - IpProtocol: -1   #On Prem FR8 DC
#        CidrIp: 10.8.0.0/20
#        Description: "On Prem FR8 DC"
#      - IpProtocol: -1   #On Prem MU4 DC
#        CidrIp: 10.8.16.0/20
#        Description: "On Prem MU4 DC"
#      - IpProtocol: "tcp"
#        CidrIp: "10.232.73.136/32"
#        FromPort: "5985"
#        ToPort:  "5986"
#        Description: "Rundeck Automation 5985-5986"

      SecurityGroupEgress:
      - IpProtocol: -1
        CidrIp: "172.16.0.0/12"
      - IpProtocol: -1
        CidrIp: "10.0.0.0/8"
      - IpProtocol: -1
        CidrIp: "192.168.0.0/16"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
      - IpProtocol: "udp"
        CidrIp: "0.0.0.0/0"
        FromPort: "53"
        ToPort: "53"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "443"
        ToPort: "443"
      - IpProtocol: "tcp"
        CidrIp: "0.0.0.0/0"
        FromPort: "80"
        ToPort: "80"
  VPC2InCDRSGDomaincontrollerRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref VPC2InCDRServersSG
      IpProtocol: -1   #Domain Controllers All In
      SourceSecurityGroupId: !Ref DomainControllerSG
      Description: Domain Controllers
  VPC2InCDRServersSGJumpRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref VPC2InCDRServersSG
      IpProtocol: -1   #Jump Servers All In
      SourceSecurityGroupId: !Ref JumpServersSG
      Description: Jump Servers
  VPC2InCDRServersSGInfratoolsRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref VPC2InCDRServersSG
      IpProtocol: -1   #Infratools Servers All In
      SourceSecurityGroupId: !Ref InfraToolsServersSG
      Description: InfraTools
  VPC2InCDRSGSSHRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref VPC2InCDRServersSG
      IpProtocol: 'tcp'
      FromPort: "22"
      ToPort: "22"
      Description: Globalscape SSH Port
      SourceSecurityGroupId: !Ref VoiceInCDRServersSG
  VPC2InCDRSGSMB139Rule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref VPC2InCDRServersSG
      IpProtocol: 'tcp'
      FromPort: "139"
      ToPort: "139"
      Description: Globalscape SMB Port
      SourceSecurityGroupId: !Ref VoiceInCDRServersSG
  VPC2InCDRSGSMB445Rule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref VPC2InCDRServersSG
      IpProtocol: 'tcp'
      FromPort: "445"
      ToPort: "445"
      Description: Globalscape SMB Port
      SourceSecurityGroupId: !Ref VoiceInCDRServersSG
  VPC2InCDRSGPrometheusRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref VPC2InCDRServersSG
      IpProtocol: -1
      SourceSecurityGroupId: !Ref PrometheusServersSG


#SG for Ribbon PSX
  Voice2RibbonPsxSecurityGroup:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue VoiceNetwork2-Vpc
      GroupDescription: Ribbon PSX security group
      Tags:
        - Key: Name
          Value:
            'Fn::Join':
              - '-'
              - - Ref: SystemName
                - psxSG
        - Key: ApplicationOwner
          Value: Voice Teams
        - Key: InfrastructureOwner
          Value: Voice Teams
        - Key: Cluster
          Value: Global
        - Key: Product
          Value: Infrastructure
        - Key: Service
          Value: AWS Voice POP
        - Key: DeviceType
          Value: Ribbon PSX
        - Key: Owner
          Value: Network Teams
        - Key: Product
          Value: Infrastructure
      SecurityGroupIngress:
        - Description: SSReq Traffic
          IpProtocol: tcp
          FromPort: '3091'
          ToPort: '3091'
          CidrIp: 0.0.0.0/0
        - Description: UDP Traffic
          IpProtocol: udp
          FromPort: '3053'
          ToPort: '3055'
          CidrIp: 0.0.0.0/0
        - Description: PES Traffic
          IpProtocol: udp
          FromPort: '9004'
          ToPort: '9004'
          CidrIp: 0.0.0.0/0
        - Description: DNS UDP
          IpProtocol: udp
          FromPort: '53'
          ToPort: '53'
          CidrIp: 0.0.0.0/0
        - Description: NTP
          IpProtocol: udp
          FromPort: '123'
          ToPort: '123'
          CidrIp: 0.0.0.0/0
        - Description: DBREPD Data
          IpProtocol: tcp
          FromPort: '3080'
          ToPort: '3080'
          CidrIp: 0.0.0.0/0
        - Description: ICMP Ping
          IpProtocol: icmp
          FromPort: '-1'
          ToPort: '-1'
          CidrIp: 0.0.0.0/0
        - Description: SIPE TCP Traffic
          IpProtocol: tcp
          FromPort: '5060'
          ToPort: '5060'
          CidrIp: 0.0.0.0/0
        - Description: JAVA
          IpProtocol: udp
          FromPort: '161'
          ToPort: '161'
          CidrIp: 0.0.0.0/0
        - Description: DBREPD Control
          IpProtocol: tcp
          FromPort: '3090'
          ToPort: '3090'
          CidrIp: 0.0.0.0/0
        - Description: SSH to CLI
          IpProtocol: tcp
          FromPort: '22'
          ToPort: '22'
          CidrIp: 0.0.0.0/0
        - Description: Sonus Agent
          IpProtocol: tcp
          FromPort: '19991'
          ToPort: '19991'
          CidrIp: 0.0.0.0/0
        - Description: SIPE UDP Traffic
          IpProtocol: udp
          FromPort: '5060'
          ToPort: '5060'
          CidrIp: 0.0.0.0/0
        - Description: SFTP Traffic
          IpProtocol: tcp
          FromPort: '6462'
          ToPort: '6462'
          CidrIp: 0.0.0.0/0
        - Description: Service Director
          IpProtocol: tcp
          FromPort: '5000'
          ToPort: '5000'
          CidrIp: 0.0.0.0/0
        - Description: PostgreSQL listener
          IpProtocol: tcp
          FromPort: '5432'
          ToPort: '5432'
          CidrIp: 0.0.0.0/0
        - Description: Pgbouncer
          IpProtocol: tcp
          FromPort: '6432'
          ToPort: '6432'
          CidrIp: 0.0.0.0/0
        - Description: RAMP registration
          IpProtocol: tcp
          FromPort: '443'
          ToPort: '443'
          CidrIp: 0.0.0.0/0
        - Description: DNS/ENUM TCP
          IpProtocol: tcp
          FromPort: '53'
          ToPort: '53'
          CidrIp: 0.0.0.0/0
      SecurityGroupEgress:
        - IpProtocol: -1
          CidrIp: 0.0.0.0/0


  Voice2RibbonPsxSGJumpRule:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref Voice2RibbonPsxSecurityGroup
      IpProtocol: -1   #Jump Servers All In
      SourceSecurityGroupId: !Ref JumpServersSG


  BMCAPIServerSG:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      VpcId: !ImportValue DMZNetwork-Vpc
      GroupDescription: sg for BMCAPI Server
      Tags:
        - Key: Name
          Value: global_tools_BMCAPI_server_sg
        - Key: DeviceType
          Value: Network Security Group
        - Key: InfrastructureOwner
          Value: Network Teams
        - Key: ApplicationOwner
          Value: Network Teams
        - Key: Product
          Value: SecurityGroup
      SecurityGroupIngress:
      - IpProtocol: -1
        CidrIp: "10.232.152.0/21"
        Description: "Core VPC"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,RundeckServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "Rundeck Automation"
      - IpProtocol: "tcp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"
      - IpProtocol: "udp"
        CidrIp: !FindInMap [ VPCaddressPrefix,values,BMPCSServerIP ]
        FromPort: "5985"
        ToPort: "5986"
        Description: "BMPCS Monitoring"
      SecurityGroupEgress:
        - IpProtocol: -1
          CidrIp: 0.0.0.0/0
  BMCAPIServerSGLoadBalancerRuleIn:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !Ref BMCAPIServerSG
      IpProtocol: -1   #Internal Cluster
      SourceSecurityGroupId: !Ref ClusterALBSecurityGroup          


Outputs:
  DMZVPCSubnet:
    Description: DMZ VPC Subnet
    Value: !FindInMap [ VPCaddressPrefix,values,DMZVPCSubnet ]
    Export:
      Name: GlobalSecurityGroups-DMZSubnet
  CoreVPCSubnet:
    Description: Core VPC Subnet
    Value: !FindInMap [ VPCaddressPrefix,values,CoreVPCSubnet ]
    Export:
      Name: GlobalSecurityGroups-CoreSubnet
  DomainControllerSG:
    Description: Domain Controller Security Group
    Value: !Ref DomainControllerSG
    Export:
      Name: GlobalSecurityGroups-DomainControllerSG
  JumpServersSG:
    Description: Jump Servers Security Group
    Value: !Ref JumpServersSG
    Export:
      Name: GlobalSecurityGroups-JumpServersSG
  IntDNSServersSG:
    Description: Internal DNS Security Group
    Value: !Ref IntDNSServersSG
    Export:
      Name: GlobalSecurityGroups-IntDNSServersSG
  ChefServersSG:
    Description: Chef Servers Security Group
    Value: !Ref ChefServersSG
    Export:
      Name: GlobalSecurityGroups-ChefServersSG
  BidServersSG:
    Description: Bid Servers Security Group
    Value: !Ref BidServersSG
    Export:
      Name: GlobalSecurityGroups-BidServersSG
  ASRServersSG:
    Description: ASR Servers Security Group
    Value: !Ref ASRServersSG
    Export:
      Name: GlobalSecurityGroups-ASRServersSG
  TTSServersSG:
    Description: TTS Servers Security Group
    Value: !Ref TTSServersSG
    Export:
      Name: GlobalSecurityGroups-TTSServersSG
  FTPINTServersSG:
    Description: FTP Internal Servers Security Group
    Value: !Ref FTPINTServersSG
    Export:
      Name: GlobalSecurityGroups-FTPINTServersSG
  SophosServersSG:
    Description: Sophos Servers Security Group
    Value: !Ref SophosServersSG
    Export:
      Name: GlobalSecurityGroups-SophosServersSG
  BMINTServersSG:
    Description: BMINT Servers Security Group
    Value: !Ref BMINTServersSG
    Export:
      Name: GlobalSecurityGroups-BMINTServersSG
  BMPCSServersSG:
    Description: BMPCS Servers Security Group
    Value: !Ref BMPCSServersSG
    Export:
      Name: GlobalSecurityGroups-BMPCSServersSG
  MailDirectorServersSG:
    Description: Mail Director Servers Security Group
    Value: !Ref MailDirectorServersSG
    Export:
      Name: GlobalSecurityGroups-MailDirectorServersSG
  GlobalWebServersSG:
    Description: Global Web Servers Security Group
    Value: !Ref GlobalWebServersSG
    Export:
      Name: GlobalSecurityGroups-GlobalWebServersSG
  WSUSServersSG:
    Description: WSUS Servers Security Group
    Value: !Ref WSUSServersSG
    Export:
      Name: GlobalSecurityGroups-WSUSServersSG
  InmailSGDMZ:
    Description: Inmail Security Group
    Value: !Ref InmailSGDMZ
    Export:
      Name: GlobalSecurityGroups-InmailSGDMZ
  DBMonServersSG:
    Description: DBMon Security Group
    Value: !Ref DBMonServersSG
    Export:
      Name: GlobalSecurityGroups-DBMonServersSG
  InlogServersSG:
    Description: Inlog Security Group
    Value: !Ref InlogServersSG
    Export:
      Name: GlobalSecurityGroups-InlogServersSG
#  InlmoServersSG:
#    Description: Logic Monitor Security Group
#    Value: !Ref InlmoServersSG
#    Export:
#      Name: GlobalSecurityGroups-InlmoServersSG
  InCDRServersSG:
    Description: InCDR Security Group
    Value: !Ref InCDRServersSG
    Export:
      Name: GlobalSecurityGroups-InCDRServersSG
  InFTPSGDMZ:
    Description: InFTP Security Group
    Value: !Ref InFTPSGDMZ
    Export:
      Name: GlobalSecurityGroups-InFTPSGDMZ
  NWFMServersSG:
    Description: NWFWM Server Security Group
    Value: !Ref NWFMServersSG
    Export:
      Name: GlobalSecurityGroups-NWFMServersSG
  RLRServersSG:
    Description: RLR Server Security Group
    Value: !Ref RLRServersSG
    Export:
      Name: GlobalSecurityGroups-RLRServersSG
  VPC2RLRServersSG:
    Description: RLR Server Security Group
    Value: !Ref VPC2RLRServersSG
    Export:
      Name: GlobalSecurityGroups-VPC2RLRServersSG
  ClusterALBSecurityGroup:
    Description: SG for Cluster SG's
    Value: !Ref ClusterALBSecurityGroup
    Export:
      Name: GlobalSecurityGroups-ClusterALBSecurityGroup
  VPC2ASRServersSG:
    Description: ASR Servers Security Group
    Value: !Ref VPC2ASRServersSG
    Export:
      Name: GlobalSecurityGroups-ASRServersSG-Vpc2
  VPC2TTSServersSG:
    Description: TTS Servers Security Group
    Value: !Ref VPC2TTSServersSG
    Export:
      Name: GlobalSecurityGroups-TTSServersSG-Vpc2
  ASideADCSelfIP:
    Description: A Side F5 Self IP
    Value: !FindInMap [ VPCaddressPrefix,values,ASideADCSelfIP ]
    Export:
      Name: GlobalSecurityGroups-ASideADCSelfIP
  BSideADCSelfIP:
      Description: B Side F5 Self IP
      Value: !FindInMap [ VPCaddressPrefix,values,BSideADCSelfIP ]
      Export:
        Name: GlobalSecurityGroups-BSideADCSelfIP
  ASideADCSNATIP:
      Description: A Side F5 SNAT IP
      Value: !FindInMap [ VPCaddressPrefix,values,ASideADCSNATIP ]
      Export:
        Name: GlobalSecurityGroups-ASideADCSNATIP
  BSideADCSNATIP:
      Description: B Side F5 SNAT IP
      Value: !FindInMap [ VPCaddressPrefix,values,BSideADCSNATIP ]
      Export:
        Name: GlobalSecurityGroups-BSideADCSNATIP
  NoConnTrackF5:
      Description: F5 No Conntrack SG
      Value: !Ref NoConnTrackF5
      Export:
        Name: GlobalSecurityGroups-NoConnTrackCoreF5
#  SBCTrustInterface:
#    Description: Trust interface for SBCs
#    Value: !Ref SBCTrustInterface
#    Export:
#      Name: GlobalSecurityGroups-SBCTrustInterface
#  SBCTrustInterface2:
#    Description: Trust interface for SBCs
#    Value: !Ref SBCTrustInterface2
#    Export:
#      Name: GlobalSecurityGroups-SBCTrustInterface2
  VPC2COMServersSG:
    Description: COM Servers Security Group
    Value: !Ref VPC2COMServersSG
    Export:
      Name: GlobalSecurityGroups-CompressionServersSG-Vpc2
  COMServersSG:
      Description: COM Servers Security Group
      Value: !Ref COMServersSG
      Export:
        Name: GlobalSecurityGroups-CompressionServersSG
  GlobalDBServersSG:
      Description: Global Database Server Security Group
      Value: !Ref GlobalDBServersSG
      Export:
        Name: GlobalSecurityGroups-GlobalDBServersSG
  InternalGlobalWebServersSG:
      Description: Global Internal Web Server Security Group
      Value: !Ref InternalGlobalWebServersSG
      Export:
        Name: GlobalSecurityGroups-InternalGlobalWebServersSG
  InternalCertificateServersSG:
      Description: Global Internal Certificate Servers Security Group
      Value: !Ref InternalCertificateServersSG
      Export:
        Name: GlobalSecurityGroups-InternalCertificateServersSG
  SnowdiscSG:
      Description: SNOW Discovery Servers
      Value: !Ref SnowdiscSG
      Export:
        Name: GlobalSecurityGroups-SnowdiscSG
  NWRadiusSG:
      Description: Network Radius Servers
      Value: !Ref NWRadiusSG
      Export:
        Name: GlobalSecurityGroups-NWRadiusSG

#    ThousandEyesDMZSG:
#      Description: Thousand Eyes DMZ Servers
#      Value: !Ref ThousandEyesDMZSG
#      Export:
#        Name: GlobalSecurityGroups-ThousandEyesDMZSG
#    ThousandEyesCoreSG:
#      Description: Thousand Eyes Core Servers
#      Value: !Ref ThousandEyesCoreSG
#      Export:
#        Name: GlobalSecurityGroups-ThousandEyesCoreSG
  ACOVOC2ServersSG:
      Description: Audio Codes OVOC Servers
      Value: !Ref ACOVOC2ServersSG
      Export:
        Name: GlobalSecurityGroups-ACOVOC2ServersSG
  ACOVOCServersSG:
      Description: Audio Codes OVOC Servers
      Value: !Ref ACOVOCServersSG
      Export:
        Name: GlobalSecurityGroups-ACOVOCServersSG
  InfraToolsServersSG:
      Description: Infra Tools Servers
      Value: !Ref InfraToolsServersSG
      Export:
        Name: GlobalSecurityGroups-InfraToolsServersSG

  InlmoServersSG:
    Description: Logic Monitor Security Group
    Value: !Ref InlmoServersSG
    Export:
      Name: GlobalSecurityGroups-InlmoServersSG


  ThousandEyesCoreSG:
    Description: Thousand Eyes Core Servers
    Value: !Ref ThousandEyesCoreSG
    Export:
      Name: GlobalSecurityGroups-ThousandEyesCoreSG

  PrometheusServersSG:
    Description: Prometheus Servers
    Value: !Ref PrometheusServersSG
    Export:
      Name: GlobalSecurityGroups-PrometheusServersSG


  SystemsOktaADAgentServerSG:
    Description: Prometheus Servers
    Value: !Ref SystemsOktaADAgentServerSG
    Export:
      Name: GlobalSecurityGroups-SystemsOktaADAgentServerSG

  BMCMonitoringServerSG:
    Description: BMC Servers
    Value: !Ref BMCMonitoringServerSG
    Export:
      Name: GlobalSecurityGroups-BMCMonitoringServerSG

  RundeckServerSG:
    Description: Rundeck Server
    Value: !Ref RundeckServerSG
    Export:
      Name: GlobalSecurityGroups-RundeckServerSG

  SolarwindsServerSG:
    Description: Solarwinds Server
    Value: !Ref SolarwindsServerSG
    Export:
      Name: GlobalSecurityGroups-SolarwindsServerSG


  SolarWindsNPMServerSG:
    Description: SolarWindsNPM Server
    Value: !Ref SolarWindsNPMServerSG
    Export:
      Name: GlobalSecurityGroups-SolarWindsNPMServerSG

  BMCCapacityServerSG:
    Description: BMCCapacity Server
    Value: !Ref BMCCapacityServerSG
    Export:
      Name: GlobalSecurityGroups-BMCCapacityServerSG


  CostGuardWebServiceServerSG:
    Description: CostGuardWebService Server
    Value: !Ref CostGuardWebServiceServerSG
    Export:
      Name: GlobalSecurityGroups-CostGuardWebServiceServerSG


  BgFTPSGDMZ:
    Description: Billing FTP Server
    Value: !Ref BgFTPSGDMZ
    Export:
      Name: GlobalSecurityGroups-BgFTPSGDMZ

  SonusNLBSecurityGroup:
    Description: Sonus Provisioning NLB SG
    Value: !Ref SonusNLBSecurityGroup
    Export:
      Name: GlobalSecurityGroups-SonusNLBSecurityGroup


  VoiceInCDRServersSG:
    Description: Voice Network INCDR SG
    Value: !Ref VoiceInCDRServersSG
    Export:
      Name: VoiceNetwork-InCDRServersSG

  InternalServerSecurityGroup:
    Description: SG for Internal Components
    Value: !Ref InternalServerSecurityGroup
    Export:
      Name: VoiceNetwork-InternalServerSecurityGroup


  RibbonAnalyticsSG:
    Description: Voice Network  RibbonAnalyticsSG
    Value: !Ref RibbonAnalyticsSG
    Export:
      Name: VoiceNetwork-RibbonAnalyticsSG


  VoiceRibbonPsxSecurityGroup:
    Description: Voice Network RibbonPsxSG
    Value: !Ref VoiceRibbonPsxSecurityGroup
    Export:
      Name: VoiceNetwork-RibbonPsxSG


  VPC2InCDRServersSG:
    Description: Voice Network2 INCDR SG
    Value: !Ref VPC2InCDRServersSG
    Export:
      Name: VoiceNetwork2-InCDRServersSG

  VPC2InternalServerSecurityGroup:
    Description: Voice VPC 2 SG for Internal Components
    Value: !Ref VPC2InternalServerSecurityGroup
    Export:
      Name: VoiceNetwork2-InternalServerSecurityGroup


  Voice2RibbonPsxSecurityGroup:
    Description: Voice Network 2 RibbonPsx SG
    Value: !Ref Voice2RibbonPsxSecurityGroup
    Export:
      Name: VoiceNetwork2-RibbonPsxSG


  BMCAPIServerSecurityGroup:
    Description: BMCAPI Server SG
    Value: !Ref BMCAPIServerSG
    Export:
      Name: GlobalSecurityGroups-BMCAPIServersSecurityGroup

  TechSupportToolsServerSecurityGroup:
    Description: TechSupportTools Server SG
    Value: !Ref TechSupportToolsServerSG
    Export:
      Name: GlobalSecurityGroups-TechSupportToolsServerSecurityGroup